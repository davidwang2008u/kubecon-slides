Observability Brings Clarity in 5G World: DSES-7399 - events@cncf.io - Thursday, November 19, 2020 2:57 PM - 34 minutes

Participant: wordly [W] English (US)

Transcription for wordly [W]

00:00:00 [W] Hello everyone.
00:00:01 [W] Welcome to our talk on observability brings Clarity in Fiji world.
00:00:05 [W] My name is Praveen George.
00:00:07 [W] I'm a senior principal engineer working in Fiji System.
00:00:11 [W] test team and affirm networks.
00:00:13 [W] Along with me is my colleague yemenis ridden.
00:00:15 [W] Engineer leading the platform as a service team in Affirmed.
00:00:19 [W] Home networks is a Telco company as of April 20 20.
00:00:24 [W] We are a fully owned subsidiary of Microsoft and from now before 2020 will be completely integrated into you Microsoft Azure team.
00:00:33 [W] Agenda for today's talk is to First provide an overview of algae networks, and then we'll see.
00:00:40 [W] what are the key observability requirements in 5G and how they are satisfied using the cncf observability stack, especially for metric collection logging and phrasing and also we will see the demos
00:00:55 [W] Telecom Network architecture the various Network elements in the network. It supported protocols the interfaces that each Network element support Etc defined by a standardization body called the GP in 5G
00:00:54 [W] This is called as Network functions and they are deployed in different kubernative clusters in different Geographic locations.
00:00:58 [W] Each Network function will contain at least 10 to 15 different types of microservices within it as I mentioned before in a 5 G coredns network.
00:01:09 [W] There are various virtual Network functions deployed in multiple kubenetes clusters across different Geographic locations. This is a very simplified Network diagram of 5G core.
00:01:22 [W] And whenever a user equipment rice 2 registers with a network or attaches to the it work, there are a series of three GP Define messages that are exchanged between various Network functions over the 3gpp defined interfaces before the
00:01:37 [W] Either browser data or make a phone call.
00:01:42 [W] This brings our first requirement that we should be able to continuously monitor performance of multiple Network functions.
00:01:49 [W] also has the messages are exchanged between different network functions of a different network interfaces. It's highly likely that that can be a fault in where the network at any point of time.
00:02:03 [W] This brings our next requirement that we should be able to detect the problem at the very early stages by some sort of automated mechanism or alerting mechanism in a typical Legacy Network.
00:02:17 [W] The people will be staring at different G.
00:02:19 [W] Why's for any anomalies or any alarms?
00:02:22 [W] We need to have a way to automate that process here.
00:02:26 [W] And the other requirement is that once a problem is detected.
00:02:29 [W] We should be able to troubleshoot the problem with the earliest and then resolve the issue at the earlier so that there is minimum in back to customers like us right. So for that all the relevant debug information whether it's
00:02:44 [W] logs whether it is freezes, everything should be readily available and I centralized location like a dashboard kind of thing so that it's
00:02:46 [W] It's available for the developers of the support people to debug the issue.
00:02:51 [W] Let's now see one of the important key features in Phi G, which is called as Network slicing the Advent of 5G the applications which access defy G network has different requirements.
00:03:03 [W] Hey, there are some applications like gaming applications which would need high-speed internet connectivity. Then there are iot related applications, which would need a huge number of devices to be connected to the network.
00:03:16 [W] But they may not be using the are complete bandwidth or they may not need a high-speed bandwidth at any point of time.
00:03:25 [W] And then there are more Mission critical applications like an example is MM autonomous car driving mechanism, which would need high speed internet connectivity as well as very high reliability in the network.
00:03:39 [W] They should be zero latency for those applications.
00:03:42 [W] So depending on the applications requirements. It's not possible to provide separate separate 5G networks.
00:03:50 [W] So the solution is something called is Network slicing where the underlying 5G Network.
00:03:55 [W] Particular slice this brings our next requirement that though we can collect data from different network functions.
00:03:51 [W] We should be able to figure gate the data collected from different network functions based on the slides from which it is coming.
00:04:01 [W] Let's now see how these key 5G observability requirements are satisfied using cncf observability stack.
00:04:10 [W] Yamini will walk us through that.
00:04:12 [W] Thank you.
00:04:14 [W] Hi guys. I am nice.
00:04:16 [W] I work as a senior principal software engineer at FM Network or Microsoft company.
00:04:25 [W] In today's session. We will see how cncf observability stack brings Clarity in 5G world as prevent mentioned earlier the 5 G World consists of different
00:04:40 [W] Lord in different geological locations
00:04:40 [W] the challenges we had when we considered bringing Clarity in 5G world are monitoring the performance of NF for the deduction end-to-end call treason.
00:04:53 [W] Few of our cncf observability component as its has to be solvable challenges and bring more clarity into 5G world.
00:05:08 [W] monitoring the performance of a nurse in 5G world
00:05:13 [W] Prometheus and Griffon arm has helped us bring Clarity in monitoring the performance of Indians in this slide. We have few sample in herbs like SMF and am
00:05:26 [W] we would like to monitor the performance of SMR as per the slide.
00:05:32 [W] Prometheus Library helps us in creating the gouges counters and histogram
00:05:39 [W] and the URI for the Prometheus serverless looking pull them in trees this Matrix are helpful in monitoring the performance of mmm.
00:05:49 [W] example, we would like to know number of requests reached SMS.
00:05:55 [W] Let us know that number of requests has been.
00:05:52 [W] Reach SMF.
00:05:54 [W] So the metric value helps us in giving a Clarity on how the performance of the NFL and F's are taken care of.
00:06:07 [W] The Prometheus pulls the metrics and saves it in the time series database.
00:06:14 [W] the other truth have expression they use the metric value with the arithmetic operation and the expression evaluates in a particular time interval and fires the alerts to the alert manager the alert manager
00:06:29 [W] Still looks through a lot receiver example slack or email.
00:06:28 [W] The Griffon our visualization to it's a popular visualization to which has a data source and few wish realization plugins.
00:06:39 [W] So we have used few of the plugins example Raff.
00:06:45 [W] Speedometer table and it gives the end user or visualization effects of the metric value which brings more clarity of the performance of the MLS.
00:06:58 [W] Let's see a demo on how we use the Prometheus and graph on R to bring more clarity in monitoring the performance of NFC in 5G world.
00:07:17 [W] Now we will look into the Prometheus of Prometheus our brings more clarity in monitoring the performance of energy in 5G world.
00:07:32 [W] Let's look how it brings our clarity.
00:07:36 [W] This particular metric is from am FCC micro service, which is a 5 G related Michael service and the metric has
00:07:51 [W] Most CC who does microservices name as well as the message transfer your question.
00:07:52 [W] So this particular Matrix will give us a Clarity that how many number of times the message transfer request has been achieved in
00:08:07 [W] S Praveen mentioned in earlier in one office.
00:07:58 [W] S probably mentioned in earlier in one office.
00:07:58 [W] So this slice which is a label over here will leads to the network slice.
00:08:13 [W] So we have as per this metrics. We have achieved 136 message request transfer referenced in this particular slice.
00:08:27 [W] Like that, we have many metrics.
00:08:30 [W] Which is being pulled from each and container of 5G and saved in the time series data base by Prometheus for aggregating the Matrix and the alert
00:08:45 [W] and any other ultimate Expressions the rule is the record rule is a rule which gives you an expression for any arithmetic expression which Prometheus supports for
00:08:59 [W] Shouldn't hear a song of a particular metric name without considering the label.
00:08:59 [W] In Prometheus, once we click new record rule this particular record mean becomes a metric itself and stole the time series data base.
00:09:10 [W] Once we click on your this particular Matrix.
00:09:15 [W] Which was a record room becomes a metric name with a corresponding labels per slice with the values how many attempts has happened for this particular slice?
00:09:28 [W] In this manner, we get clarity of the performance of NF in the 5G room.
00:09:38 [W] We have the other tools. The other truths has the alert name and the expression this expression includes the metric name or the record room named with of
00:09:53 [W] of the performance of NF in the 5G world
00:09:58 [W] We have the other tools.
00:10:00 [W] The other truth has the alert name and the expression this expression includes the metric name or the record true name with of customized expression
00:10:25 [W] generalized expression as per the business logic
00:10:30 [W] and this expression is X evaluated every minute as per the for duration here with the label matching and this app description and summary will be
00:10:45 [W] It in the receiver, which was configured in alert manager.
00:10:52 [W] This expression if it is the evaluated and the evaluation result is true. The Prometheus starts firing alerts to the alert management
00:11:07 [W] Valuation result is true.
00:11:06 [W] the Prometheus starts firing alerts to the alert manager and the alert manager will further start forwarding the alerts to the receiver configured in the event manager.
00:11:22 [W] And this here the metric name is used with the full expression will give the proper value and that value will be considered with the evaluated expression value.
00:11:35 [W] This is an example of an alert through and this gives on we will come to know because of this alerting system that if any Pokémon performance of the
00:11:50 [W] Is going down or it's not is it unexpected of performance we have to we can have a Clarity in the Prometheus or no Clarity by seeing the graph and let's see the graph on R. Which
00:12:05 [W] Which corresponds to this Prometheus?
00:12:09 [W] This is the Griffon.
00:12:11 [W] Mmm. We have configured the Griffon with multiple dashboards for each container and Michael services and we have configured the dashboards.
00:12:27 [W] And data source the data source in this fauna ravana by these holds supports many data source, but we use Prometheus.
00:12:38 [W] Primitives this data source is configured in an auto provisioning method using the Griffon Olympia.
00:12:48 [W] and the dashboards are each and every microservices has its own dashboards and it is provisioned in Griffon are
00:13:08 [W] using the graph on R equals X for Griffon a dashboards and deficits. We are doing automatic proposition using the Griffon impa
00:13:21 [W] Master dashboard, for example
00:13:25 [W] Reviewing the dashboard we will come to know that.
00:13:30 [W] Values and even in a visualization we whole successfully this and we can achieve this by writing queries.
00:13:43 [W] This query once we select the data source.
00:13:47 [W] This query is the prompt you will query which is going to query the Prometheus and the metric name mentioned here is in Prometheus and it gives the value of according
00:14:02 [W] And some more clarity we can have a database query as well.
00:14:04 [W] So this particular dashboard has graphql tables and swill has more queries which gives a good Clarity of with what time and what
00:14:20 [W] Those particular variable values metric values are available.
00:14:20 [W] For example, here.
00:14:23 [W] We see a metric value as per the cursor wherever we keep the cursor. We will come to know the exact metric Wendy which gives us a more clarity and a way of
00:14:38 [W] visualizing The Matrix
00:14:46 [W] now we go into the next challenge of all deduction using centralized for me.
00:14:53 [W] so SMF and am a father 5G Network and MFC which
00:15:00 [W] has which can go down or which can create any fault in the enemies. So we have structured actionable laws, which have been created by the anynines.
00:15:29 [W] And it forwards the log to the elastic search and stores the law in the elastic search.
00:15:37 [W] Seamless, the receivers can be slack or email or Web book. So it depends upon the elastic alert rules that this rule has to be evaluated with a structured
00:15:49 [W] And the particular events though expression is satisfied or evaluated fine.
00:15:47 [W] The particular alerts are being forwarded to the receivers after forwarding it to the receivers. If we want to see more clarity in the logs. The Cabana is a
00:16:03 [W] Forwarding it to the receivers if we want to see more clarity in the logs.
00:16:06 [W] The Cabana is a user-friendly UI which gives a more clarity in the lungs. Let's see a quick demo on the Cabana.
00:16:26 [W] Now, let's see the t-bar now which gives more clarity in visualizing the logs the fall deduction.
00:16:36 [W] happens in NF structure
00:16:42 [W] actionable logs are saved in elastic search and the elastic alert, which has the rooms will be very elastic search and if it sees a
00:16:58 [W] Which gives more clarity in visualizing the logs the fall deduction?
00:17:07 [W] happens in NF1 structure
00:17:12 [W] actionable logs are saved in elastic search and the elastic alert, which has the rooms will be very elastic search and if it sees a rule which is
00:18:13 [W] Similar law it will start forwarding the alerts to the elastic alert receiver.
00:18:21 [W] So the key banal gives more clarity which log has given the actionable long.
00:18:30 [W] These are few logs, which we have in our energy.
00:18:36 [W] So the clarity which the end of gives is.
00:18:42 [W] is in a Json format and once you expand it, we will come to know each and every
00:18:51 [W] Label value and what is the level of severity and Camera gives us more flexibility by creating indexes.
00:19:02 [W] We can create indexes.
00:19:06 [W] Index patterns and we can use our own filters. This filters are very useful when we will search for the particular.
00:19:22 [W] or a particular label in a huge number of months
00:19:27 [W] and these are the already configured available fields.
00:19:35 [W] Thanks.
00:19:37 [W] Let's see now.
00:19:44 [W] Now, let's look into the end-to-end called racing.
00:19:47 [W] The n2n call tracing is a challenge. We had to bring Clarity into file G. For example, we establish your call in the 5G world and a call drops of
00:20:03 [W] And we need to develop the reason for the call dropper to rectify the issue.
00:20:09 [W] So the say SMF and AMF are the 5 G Ms.
00:20:14 [W] Well, we need to incorporate although opentracing in those containers and opentracing creates a traces and spans and this traces and spans are
00:20:29 [W] reason for the call dropper to rectify the issue
00:20:20 [W] So the say SMF and AMF are the 5 G Ms.
00:20:24 [W] Well, we need to incorporate although opentracing in those containers and opentracing creates a traces and spans.
00:20:38 [W] This traces and spans are collected by the eager agent and forwarded to the elastic database the elastic database stores these stresses and spans and the eager UI.
00:20:57 [W] The eagle agent and forwarded to the elastic database the elastic database stores these stresses and spans and the eager UI displaces the traces and
00:21:12 [W] Glad you do.
00:21:14 [W] A demo on eager will be provided by my colleague premiere.
00:21:22 [W] And thank you.
00:21:28 [W] Before I start with the end opentracing demo, let me ask you one thing.
00:21:31 [W] How many of you have faced issues with your mobile network connection could be different issues. Like we are not able to browse internet or our friends or relatives would a complaint or saying that they were trying to reach us, but the costs are
00:21:46 [W] So 7 those kind of issues we would have paste.
00:21:49 [W] And it's common that we would have called the customer support center to erase a ticket with them to look into what is going wrong with our connection.
00:21:58 [W] In a legacy network, if you reset equipped with customer support center, what they do is they'll collect logs from different nodes look into the logs and then see that Node 1 is healthy then look into the node next set of locks for
00:22:14 [W] They'll see Note 2's healthy, then go to the next set of Love locks debug information from node 3 and then they will identify the problem which means that the debugging process is difficult.
00:22:20 [W] takes time, which ultimately backs the customers like us.
00:22:27 [W] Okay, so we are trying to see how we can use agar tracing to make the debugging process easier.
00:22:35 [W] Whenever a customer calls a customer support center and races a ticket with them each user equipment will be having a unique identifier using that unique identifier. We can start Eggert racing in the network.
00:22:51 [W] Say here the access network gets terminated on on the AMF.
00:22:56 [W] So I am f using command line interface. We can enable linkerd racing.
00:23:02 [W] The requirement is that we should be able to trace messages exchanged across all the network functions in the network.
00:23:07 [W] You should be able to capture the traces towards nsmcon RF a vessel for U DM s MF across the network.
00:23:16 [W] We should be able to trace the network also each Network function.
00:23:19 [W] Has at least 10 to 15 different microservices type we should be able to trace the messages exchanged between the different micro service type as well.
00:23:29 [W] Customer Support Center
00:23:26 [W] the interest of saving time. I already ran a called The backend and collected the trees.
00:23:31 [W] There is one trace for a 3gpp defined procedure called video establishment procedure and it has 37 spans.
00:23:40 [W] Let's look into the details of this phrase.
00:23:45 [W] I mentioned before that the prices will be started at AMF and on the AMF it the phrases will be started at AMF into microservices.
00:23:56 [W] When the message is exchanged from AMF into two other different microservices within an NF or across ANF all those phrases will appear as child spams.
00:24:09 [W] The first race is the first trans man is a message towards MF call control and from MF call control. The message will be sent to nsmcon, which is a separate NF then the message will be sent to another F, which is a separate enough for
00:24:24 [W] And then once the discovery happens the message will be sent to SMF enough itself.
00:24:23 [W] Turn SMF we can on any Trace we can capture the various internal events in the log section.
00:24:31 [W] So these are more like similar to the logs that we see in Cabana.
00:24:36 [W] This gives more insight into what is happening. Whenever a message is received at the particular micro service. It also captures the duration of the delay or the latency associated with each event
00:24:51 [W] enough
00:24:44 [W] Like I said, I'm trying to simulate the problem where a user has a static a in this case the PD establishment procedure the last priests or the child span has for discovering a PC of data
00:25:00 [W] Asked priests or the child span as for discovering a PC of data here as we could see there is an error for discovering a PCR from another F. And there is no PC of configured.
00:25:09 [W] For discovering a PCR from an RF and there is no PC of configured.
00:25:14 [W] So this is why the calls are failing for the reported customer.
00:25:18 [W] It could the failure could be two different reason. It could be some configuration missing or it could be that the PCF is not dynamically registered with an era.
00:25:27 [W] But at least we got a starting point as to what is actually going wrong with the network now we can browse the data in Cabana and see more details more specific details.
00:25:38 [W] He's into it and then take corrective actions.
00:25:41 [W] Also another important aspect with a great racing. Is that as I mentioned before it helps to understand the latency or the bottlenecks in the network, especially how long each function or each Network function is taking
00:25:56 [W] Guilherme sees and then five G's all about low latency, right so we can see where the bottleneck is and then address that problem as well.
00:26:09 [W] That concludes our demo and our talk.
00:26:11 [W] Hope you all enjoyed our talk.
00:26:13 [W] Thanks for your time.
00:26:46 [W] Hello. We are open for Q&A if you have any questions.
00:27:17 [W] Give me that you were live under here.
00:27:34 [W] There's an equation.
00:27:37 [W] about can you re explain the last part how exactly you trees the issue so basically in a telecom Network where the customers or the mobile users report an issue, so whenever
00:27:52 [W] That with the support center. Each of the mobile subscriber will be having a unique identifier called as in Fiji terminology.
00:27:58 [W] It is called as soupy or an MC which is unique number identified with each mobile equipment.
00:28:04 [W] So using that mobile equipment, we will be monitoring or the The Operators can monitor the activity of that particular subscriber, of course with the with the
00:28:16 [W] The agreement from the specific subscriber we can monitor what are the activities that are happening and where exactly the calls are getting dropped. So for that the call failures as I assured the network
00:28:31 [W] The call failures can happen on a different network functions.
00:28:32 [W] So it's the responsibility that one of the key aspect is that we should be able to trace the messages that are exchanged between all the core products in the 5G Network.
00:28:45 [W] So as a starting point, whenever the mobile subscriber tries to make a call or browse the data, the the entry point in the core network is
00:28:57 [W] Enough virtual Network function called as access and Mobility function AMF.
00:29:04 [W] So we start the tracing from AMF onwards and for that particular subscriber, we will keep on monitoring.
00:29:10 [W] What are the activities that are happening for that particular mobile subscriber across the network within a particular NF as well as across the various enough and so in that way we will get a single span.
00:29:25 [W] they'll Trace with multiple child span where the messages are being exchanged between the nsmcon which helps us to identify say if a guy is making a phone call and at the phone call is not making through the last phrase will
00:29:35 [W] What is the error where the trace is failing by looking at the trace eager trees? We will be able to narrow down the problem and to debug more.
00:29:38 [W] So this gives an idea or a starting point as to what exactly would have caused the calls to fail, but then we will have to drill down a little bit deeper more to know as to if the calls failed due to some
00:29:53 [W] Or did the calls field to do to other network related issues or it's is it a connectivity issue? So more drill down as possible by viewing the logs section of the acre or we can either
00:30:07 [W] And view the lots and then drill down these shoes better.
00:30:09 [W] So in a legacy system, which doesn't use any of these observability aspects how the people would have to debug. This issue is to collect Wireshark traces from say if there are say Ten Network elements in the network.
00:30:24 [W] To collect ecaps from each of the network element then look at the Wireshark traces one at a time and then need to identify the problem.
00:30:32 [W] So using the egg at races. We are eliminating that problem we get a single UI and then that you either will be a single trace for a particular mobile subscriber to view all the traces across the different network element.
00:30:45 [W] So the spans and the traces are communication shows us the
00:30:53 [W] Ian of between microservices so we can make out with the tray help of traces and spans that which particular microservices be it has gone wrong with the
00:31:08 [W] - it's so in that way. It provides more information.
00:31:12 [W] We're actually the failure has occurred and the cloud native tools integrate with the Legacy environment.
00:31:20 [W] So these Cloud native tools like Prometheus Griffon instana.
00:31:35 [W] To provide the URI to pull the Matrix and like eager to have the traces and spans.
00:31:46 [W] So it can be deployed in without the cloud native, but it gives more flexibility with Cloud native Android.
00:32:01 [W] Are these trees of the available at the infrastructure level?
00:32:08 [W] How do you filter the logs in live Network? Huge logs will be there. Yes.
00:32:14 [W] So for that reason we are using Cabana.
00:32:17 [W] Kevanna has the advanced Log search.
00:32:21 [W] Dashboards where we can have a predefined filters Phil mentioned in the dashboard as well.
00:32:24 [W] So in Cloud burst, the logs are two huge so too with the particular keywords or particular or ID or slice number we can trace down the logs only for that
00:32:39 [W] Those or the you you unique ID or a particular or debug info so you can filter it has multiple filters to filter using Cabanas such technology.
00:32:56 [W] are these trees is only available at infrastructure level or we would be able to access these tools when we can access the cncf these traces are available in the 5 G infrastructure
00:33:11 [W] environment
00:33:11 [W] So these are particular these tools are used in the CNS.
00:33:17 [W] We can access these tools and all these trees has are within the our own 5j environment within the Clusters.
00:33:32 [W] That's affirmed Unity Cloud integrate with these tracing capabilities.
00:33:37 [W] Yes, we have so I found Unity cloud integrates with all these tracing capabilities with a each and every 5 G NF
00:33:52 [W] We can do tracing for our observability path components.
00:33:57 [W] We have sto also a part of our affirmed Unity Cloud. So we use stos Telemetry as well.
00:34:08 [W] So I found Unity Cloud uses the tracing the
00:34:16 [W] we need to conclude the Q&A will be available in the cube can observability Slack Road space.
00:34:22 [W] Even after the session ends we can take for the question over there.
00:34:29 [W] I need tips for scaling up observability with
00:34:35 [W] more than two
