Intro & Deep Dive: Kubernetes SIG-Storage: MYVU-2961 - events@cncf.io - Friday, November 20, 2020 5:06 PM - 40 minutes

Participant: wordly [W] English (US)

Transcription for wordly [W]

00:00:00 [W] Hello everyone today.
00:00:02 [W] We are going to give a presentation about kubernative 6 storage.
00:00:06 [W] My name is Sheena. I work at a VMware in the cloud storage team.
00:00:12 [W] Hi, I'm Michelle.
00:01:08 [W] Hello everyone. Today. We are going to give a presentation about kubernative 6 storage.
00:01:14 [W] My name is Sheena. I work at a VMware in the cloud storage 10.
00:01:20 [W] Hi, I'm Michelle.
00:01:21 [W] I am a software engineer at Google.
00:01:29 [W] So here are the six 2G leads saddle, even Google and myself are co-chairs Michelle from Google and young for Red Hat our tech leads of six storage.
00:01:44 [W] so we're going to talk about what is sick storage what we did in when the 19 release what's coming when the 20 our future plans were talked about across seek projects and working groups
00:04:47 [W] So here are the six thirty leads steadily from Google and myself are co-chairs Michelle from Google and young for Red Hat our tech leads of six storage.
00:05:02 [W] so we're going to talk about what is sick storage what we did in when the 19 release what's coming when the 20 our future plans will talk about across seek projects and working groups
00:05:41 [W] Get involved.
00:05:47 [W] So what is six origin six storageos a special interest group that focuses on how to provide storage departs in your kubernative cluster six storageos scope is in the story control plane it provides
00:06:02 [W] Our containers in the past to consume block or file storage.
00:06:07 [W] This can be persistent long-term storage that leads young reports life cycle or it can be ephemeral temporary storage which becomes available when the party started and goes away when the
00:06:22 [W] Goes away when the pot goes down six storage is responsible for the life cycle of warnings used by parts.
00:06:26 [W] This includes provisioning a new volume attaching a volume to the node and monkey it so that the part can use it among teen detaching and deleting the volume when it is no longer needed.
00:06:41 [W] Taking snapshots so that it can be used to restore the volume its original volume is corrupted for some reason.
00:06:50 [W] Sig storageos also looks at how to influence the scheduling decisions based on pathology formation to see whether the storage is accessible to a node and make sure voting is scheduled to a node.
00:07:05 [W] It is no longer needed.
00:07:08 [W] Taking snapshots so that it can be used to restore the volume if the original volume is corrupted for some reason.
00:07:17 [W] Sig storageos also looks at how to influence the scheduling decisions based on topology formation to see whether the storage is accessible to a node and make sure voting is scheduled to a node.
00:08:12 [W] Have access to the storage also six storageos responsible for managing story capacity managing quota resources based on capacities or number of resources
00:08:27 [W] Its ability to extend volume if a warrior grunts Logan stays.
00:08:37 [W] So here are some of qu the Sig storageos features six Origins the persistent volume and persistent volume claim feature. This allows soda vendor to create a volume
00:08:52 [W] Sister data in this volume, which can be preserved. Even if the particles away. We have a storage class concept sot class provides a way for administrators to describe the classes of
00:09:07 [W] Offer different classes might map to different quality of service levels.
00:09:10 [W] In Dynamic provisioning. So the class is used to find out a which provisioner should be used and what parameters should be passed to the provisional when creating the volume.
00:09:23 [W] Kubernative plugins include entry plugins out reflex loading and CSI drivers both into plugins and flux welding or deprecated ci/cd driver is the recommended way to
00:09:38 [W] The kubernative implementation of CSI has been Jason's the 1.15 release six storage has been working on migrating from entry plugins to Auto tree. CSI drivers new features are only added
00:09:50 [W] At Seaside rewards we will be talking about it the status of cni-genie Si migration in later slides.
00:09:55 [W] CSI is supported by multiple container or situation systems and storageos Anders other than position volumes.
00:10:04 [W] They were also F more volumes for Walling is specified directly import stack.
00:10:10 [W] It's mounted on the Pod as a directory and data can be stored in a file under that directory F more volumes include Secrets.
00:10:22 [W] config maps and CSI in language.
00:10:25 [W] And so on and its life cycle follows the life cycle of a pod at the bottom of this slide. You will see the Sig storage homepage visit the stage you can find lots of information
00:10:40 [W] And CSI, you know what Inns and so on and its life cycle follows the life cycle of a pod at the bottom of this slide. You will see the 6/3 homepage visit the
00:11:05 [W] the sake
00:11:09 [W] so now I'm going to talk about what we did in the one dimension release.
00:11:14 [W] There were a few features that when beta even done 19 both a Jew disk and vsphere CLI emigration was promoted to data in 1.19.
00:11:26 [W] This is part of an effort to move in Tri Club provider plugins to out which releases a drivers to use this feature user must also deploy the equivalent of
00:11:38 [W] Yes, I drove her to an Seaside migration feature flag that is defaulted on in 1017 release and also the CSI migration provider feature great for the corresponding cloud
00:11:53 [W] Deploy, the equivalent CSI drove her to an CSI migration feature flag that is defaulted on in 1017 release and also the CSI immigration provider feature
00:12:20 [W] in went on 19 Caesar Windows was also promoted to Beta see the windows was introduced as an era feature Ian 1.18 release CSI Windows relies on a sees a proxy to perform
00:12:35 [W] He's set his amongst and for my discs because Windows containers are not privileged.
00:12:42 [W] Cesar drivers communicate to see haproxy through a grpc API supported protocols include a block as Andy and Isaac Ozzy
00:12:56 [W] The other feature got promoted to Beta was immutable secrets and Catholic mass this allows secrets and config maps to the read-only both whirring expansion and whirling snapshot state
00:13:11 [W] Teen beliefs but we made a lot of improvements for expansion. We added offline voting session support detection success a driver can return a field precondition and recode if only
00:13:26 [W] Did that the user has requested a expansion when voting is a line This Way kubernative C Cyrus either side car was stopped calling controller expand volume
00:13:35 [W] Cyrus either side car was stopped calling controller extend volume for the snapshot.
00:13:40 [W] added a validation webhook to validate API objects move the snapshot apis and client library to a separate gold package.
00:13:52 [W] Even our then T. We also introduced a few new other features. We introduced this CSI story capacity tracking.
00:14:01 [W] So we added a new CSI story capacity API object in kubernative court appeared in the storageos pl group without this feature part scheduling was done without considering that the remaining story capacity may not be enough.
00:14:17 [W] The Romanian storage capacity may not be enough to start a new pod with this feature. CSI driver can report available capacities associated with Note the Balaji and food class through the debt capacity says a function.
00:14:33 [W] And kubernative scheduler will make placement decisions when choosing an order for pot base tan this information.
00:14:41 [W] This feature is a stepping stone for scoring Dynamic provisioning for local volumes.
00:14:49 [W] The second at a feature introduced in with a 19 is generic Admiral voting.
00:14:57 [W] Kubernative has one proteins whose life cycle is tied to your part and can be used as a scratch space.
00:15:06 [W] For example, we have two in anteater one type or those type of plugins can be used to load some data to a pod.
00:15:17 [W] For example, we have the beauty in config map secretive on types or CSI in line modems this new generic of marauding.
00:15:28 [W] It's different. It's actually allow any existing solely driver that supports Dynamic provisioning to provision and math Morrow volume with the volume lifecycle bound to the Pod.
00:15:42 [W] That's more rewarding.
00:15:45 [W] Kubernative has one plugins whose life cycle is tied to your part and can be used as a scratch space.
00:15:54 [W] For example, we have built-in anteater one type or those type of plugins can be used to load some data to a pod.
00:16:04 [W] For example, we have the beauty in config map secretive on types or CSI in line morons this new generic of marauding.
00:16:15 [W] It's different.
00:16:19 [W] It's actually allow any existing solely driver that supports Dynamic provisioning to provision and natural volume with the volume lifecycle bound to the Pod.
00:16:30 [W] So this can be used to provide Square story to that is different from the root disk all the parameters or the parameters used in a sort of class for the pollen provisioning are also supported by
00:16:45 [W] Certain aircraft more volume and all features supported with persistent volume cleans are supported that includes the surgical pasty tracking snapshots and resizing.
00:17:01 [W] the third new a video introducing 119 is CSI bottom Health without this feature kubernative does not check whether the volume is healthy or not after voting is provisioned with this feature
00:17:58 [W] all the parameters used in a sort of class for the holding provisioning are also supported by this generic of more volume and all features supported with persistent woman claims are supported
00:18:29 [W] TSI drivers can share abnormal or linkerd Asians from other lines through the system with kubenetes so that they can be reported as events on
00:18:45 [W] Stepping stone towards problematic detection and correction of volume health problems by kubernative.
00:18:54 [W] and the last new of a feature introducing when the 19 years CSI driver policy for f s group we added a new Alpha level field suppose FX group to the seaside driver, so
00:19:10 [W] Caesar drivers can now specify whether they support voting ownership and permission modifications
00:19:18 [W] So that's all the beta and Alpha features.
00:19:21 [W] We added in 1.19. Now, I'm going to hand it over to Michelle to talk about what's coming in the window 20 release.
00:19:30 [W] All right.
00:19:30 [W] Thank you Shane.
00:19:32 [W] So in 120, we have a lot of good things planned that are graduating first is the CSI volume snapshot feature.
00:19:43 [W] We are targeting GA in 120.
00:19:46 [W] So this feature gives you the ability to be able to take snapshots of a persistent volume claim and then be able to create new PVCs from those snapshots.
00:20:01 [W] So this is very important for for supporting the backup and restore use cases in your applications the next feature that we are planning to
00:20:16 [W] As you the ability to be able to take snapshots of a persistent volume claim and then be able to create new pbc's from those snapshots.
00:20:22 [W] So this is very important for for supporting the backup and restore use cases in your applications the next feature that we are
00:20:57 [W] Alpha to Beta is non-recursive volume ownership specifically for the fs group setting this feature gives you the ability in your
00:21:12 [W] Find that you you only want to change volume ownership of a volume only if the group the fs group setting has
00:21:27 [W] So this is an important performance enhancement for if you have a volume that has a lot of files on it and the ownership doesn't change very often.
00:21:36 [W] This will be an important feature for you to make your pods be able to start up faster.
00:21:45 [W] The third feature that we are targeting beta in 120 is is sort of related.
00:21:51 [W] It's the CSI driver policy for f s group this is the ability for a CSI driver to be able to specify if they support FS group modifications or not.
00:22:03 [W] This is planning to graduate to Beta in 120.
00:22:09 [W] And then the last feature graduation.
00:22:14 [W] As your file CSI migration and this is targeting beta in 1.20. And after I believe after this feature, add your file graduates
00:22:30 [W] Of the entry cloud provider plugins, which includes gcep D AWS CBS vsphere and Azure disk and openstack
00:22:43 [W] After 120, all of the CSI migration features will be beta and so that's for the graduating features also for new features that are being introduced
00:22:47 [W] Are targeting a new feature to be able to pass pods service account tokens to CSI drivers that's targeted to be Alpha and 1.20.
00:22:55 [W] This is this is a really important feature to enable CSI ephemeral volumes such as the cert manager and Secret store that act
00:23:10 [W] That act on behalf of PODS. So having being able to use get the Pod service account token to be able to make queries on behalf of the Pod is an important feature for
00:23:23 [W] CSI plugins
00:23:24 [W] and that's all that we have planned for 1.20 moving on to Beyond 1.20.
00:23:31 [W] We have a couple of a number of different features in the pipeline.
00:23:37 [W] First are the graduating features first is volume expansion.
00:23:45 [W] This has been long in beta for quite a few releases now and we are working.
00:23:54 [W] on trying to iron out all the remaining remaining sort of design issues and we're hoping to be able to Target a ga of this feature and 1.21
00:24:10 [W] Gordon change that we're making is we are deprecating the online offline volume expansion CSI plug-in capability the online and offline expansion is still
00:24:23 [W] just that the actual CSI capability will be deprecated and instead will be using specific error codes to be able to determine if a plug-in can support online or offline expansion
00:24:21 [W] The other feature major feature that we're planning on graduating within the next couple of releases is CSI immigration.
00:24:27 [W] So this is the effort to move all entry volume plugins to their CSI counterparts.
00:24:36 [W] So the after once all the plugins are beta in 1.20, then the next phase is going to be looking into targeting on by default.
00:24:49 [W] Default in 1.21 and assuming all goes well, then G aying of the future in 1.22 followed by the removal of the entry plug-in code.
00:25:04 [W] I think the important thing to take away here is that if you are a kubernative if you are managing your own kubernative distribution, and you are using one of these entry cloud
00:25:17 [W] um implementations then then you will definitely want to be paying attention to the CSI migration feature and work towards work towards
00:25:17 [W] It and using it in your environments as as we plan to eventually remove these plugins from the core of kubernative.
00:25:25 [W] He's around starting around 122 123 time frame the last graduating feature that we have targeted is CSI windows.
00:25:38 [W] So this is being able to support the windows OS for CSI drivers.
00:25:45 [W] I believe the target here is GA in 1.21.
00:25:49 [W] This is also still some of it is a little bit up in the air because there's the new there's a new effort going on in Sig windows for for allowing
00:26:04 [W] Dinners in Windows so that might adjust some of the time lines here, but I think for the most part are the whole di Mayne plan we have right now is to Target GA of at least CSI proxy Windows support
00:26:15 [W] So those are all the graduating features.
00:26:10 [W] We have a number of other features that are sort of in the design and prototype phase that we should be able to see sort of new all foot implementations in the upcoming
00:26:25 [W] First up is recovery from all the expansion failure.
00:26:26 [W] This is right.
00:26:29 [W] Now the way the volume expansion feature works is you can't actually undo a volume expansion request once it's started if even if it was failing so there is a
00:26:44 [W] Going on to sort of figure out how we can.
00:26:45 [W] Implement the recovery behavior in a safe way and also have it aligned with some of the other expansion efforts that are going on. In other things such as the there's a pod resizing effort going
00:27:01 [W] We'll want to make sure we align our apis to be consistent with those.
00:27:05 [W] Another feature currently under design is to be able to support non-recursive SC Linux and CSI driver configuration.
00:27:15 [W] This is very similar to the effort that is going on currently four FS group, but also applied to selinux
00:27:26 [W] Another feature is adding more plugin support for the CSI migration features. So the initial phase of CSI migration was targeting the entry
00:27:41 [W] And the next phase will be to Target some of the non cloud provider specific implementations and starting with SEF.
00:27:49 [W] So that is currently under prototype another feature that we're currently actively designing And discussing right now is volume groups.
00:28:01 [W] And this is sort of the notion that a group of PVCs are related to each
00:28:08 [W] each other in some way such as they're all all the PVCs are replicas of a particular State full set as an example and this concept is going to enable a lot of
00:28:24 [W] This is some of which include being able to have snapshot consistency across multiple volumes.
00:28:23 [W] And another use case is to be able to do failure domain spreading across volumes in the same group another feature being actively worked
00:28:38 [W] Out is the generic data populate. ER feature. This this feature offers the ability to to create third party, I guess
00:28:39 [W] Populate errs that can basically take a new be provisioned PVC inject it with some data and then hand it off to the actual poddisruptionbudgets,
00:28:50 [W] So this is a this is a very interesting use case that can for example some use cases include being able to populate particular data sets into a volume.
00:29:06 [W] example some use cases include being able to populate particular data sets into a volume before giving it to a user also being able to populate things
00:29:27 [W] Before giving it to a user also being able to populate things from like third-party third-party backup Solutions and and other use cases like that.
00:29:39 [W] So that's generic data populate errs. And then the last major feature that's currently in prototyping right now is the container object storage interface.
00:29:52 [W] This is going to sort of
00:29:56 [W] follow the patterns that CSI has developed and that the container object storage interface is going to be designed as sort of a cross
00:30:12 [W] Object storage interface layer four different object storage implementations. This effort is currently under prototype and there are there are weekly
00:30:27 [W] so definitely, if you are interested in these efforts, please join us in Sig storage and you can get you can go ahead and participate in these
00:30:31 [W] these discussions for these various features
00:30:35 [W] All right. So in addition to the projects that the Sig is directly working on we are also involved and working with other cigs in kubernative eyes to work on
00:30:51 [W] Directly working on we are also involved and working with other cigs in kubernative eyes to work on some cross Sig projects.
00:30:59 [W] First up is the data Protection work group.
00:31:04 [W] This is a work group.
00:31:05 [W] that is run by both six storage and Sig apps one of the major features that the work group is focusing on right now is how to implement.
00:31:19 [W] Quiescing an done quiescing to do application-level snapshots.
00:31:23 [W] There is a feature that the work group is is working on with Sig node called the container Notifier and this will basically provide a way to for a
00:31:39 [W] For another application or another controller to be able to run to be able to run different commands in a container to stop and stop and I guess start and stop the
00:31:54 [W] Tanner to stop and stop and I guess start and stop the file systems or rights while snapshots are taken are being taken.
00:32:03 [W] So that's a very important effort that we're currently under design and prototype right now in addition.
00:32:10 [W] We're working with Sig apps on a number of features related to stay full sets.
00:32:16 [W] First is supporting volume expansion for a stateful sets through the stateful set volume claim templates.
00:32:27 [W] and then the other feature we're working on is to be able to clean
00:32:32 [W] Up PVCs when a stateful is deleted or scaled down.
00:32:38 [W] So these are both efforts that were sort of co-working on with us Sig up.
00:32:44 [W] So be on the lookout for those.
00:32:49 [W] and then with Sig scheduling we are working on a new Alpha feature to be able to prioritize pods scheduling based off of available volume capacity and in particular node
00:33:05 [W] Is going to Target Alpha in 1.20.
00:33:13 [W] Alright, so as you can see, there are a ton of different features and projects that we are working on in Sig storage, and we would definitely appreciate
00:33:28 [W] We can get so if you are interested in getting involved, please go to our six storage communication page there. You can find the details for our bi-weekly meetings every
00:33:36 [W] Civic time every other Thursday, please join the mailing list so that you can get access to the calendar and and also the site has links for our
00:33:46 [W] that you can get access to the calendar and and also the site has links for our slack channel that you can also join and feel free to ask questions or
00:34:06 [W] All that you can also join and feel free to ask questions or if you want to get involved with anything. Feel free to ask questions in the slack as well.
00:34:20 [W] If you want to get one of the best ways to start getting involved is to just just start looking at the code.
00:34:28 [W] One of my favorite methods is to just start with the main method and walk down it until you get to the part you need.
00:34:36 [W] It's a great way to run through the code and sort of start at the top level and see where it's going.
00:34:42 [W] We have a lot of different bugs and issues that are filed.
00:34:48 [W] Old every day and we could definitely use help fixing them.
00:34:56 [W] So please if you're interested look through the open six storage issues in the communities kubernetes repo along with the kubernative CSI repo look for the help wanted labels. Also the good there's a
00:35:11 [W] label as well for those that are getting started and
00:35:19 [W] and if if you're not able to find anything there like feel free to just some you know asking the slack again and someone can go and help you out and try to find something for you.
00:35:39 [W] All right, and some other ways some other ways that folks can help out is to help right features.
00:35:47 [W] So as you can see, we have a lot of features that are sort of in progress and we can definitely use help implementing various parts of those features.
00:36:00 [W] So again, if any of these features were working on interests you please
00:36:06 [W] 10 one of our six storage buildings go ahead and asked in the chat and we can definitely connect you with the right people to get to get started on biting these features we have every
00:36:22 [W] And some other ways some other ways that folks can help out is to help right features.
00:36:18 [W] So as you can see, we have a lot of features that are sort of in progress and we can definitely use help implementing various parts of those features.
00:36:31 [W] So again, if any of these features were working on interests you please attend one of our six storage buildings go ahead and altinity.
00:36:41 [W] Asked in the chat and we can definitely connect you with the right people to get to get started on biting these features. We have every every six
00:37:55 [W] Every six storage medium we go through our six storage plan a spreadsheet which is where we track all of the features were working on for a specific kubernative release and at the beginning of every quarter. We plan the features that
00:38:10 [W] And at the beginning of every quarter, we plan the features that we want to work on for the next kubernative release.
00:38:19 [W] So these are definitely a great place to start to start getting started and if there is a new feature that you're interested in that isn't being
00:38:34 [W] If there is a new feature that you're interested in that isn't being actively worked on and you want to work on that, please please also attend the Sig storage means to talk about
00:38:49 [W] and so that we can you know, get it onto our planning spreadsheet and we can make sure all the right people are involved and that the release or that the feature will be appropriately tracked by the kubernative released Team
00:39:10 [W] alright, so that's how you can get involved with the Sig and with if I guess this session is the last session of coupon, but if you've missed
00:39:25 [W] Interested in seeing other storage sessions that were going on. Here are the links to a lot of the other storage presentations that have already happened.
00:39:36 [W] I think all of these videos should be available on YouTube in the next couple of days. So if you see something that is interesting to you, please feel free to check out those other sessions.
00:39:54 [W] All right, so, I think we are done for the presentation here, and I guess we'll go to a QA now. Thank you.
