Dragonfly: Make Image Distribution Efficiently and Safely in Cloud Native: SNEF-1860 - events@cncf.io - Wednesday, November 18, 2020 5:47 PM - 35 minutes

Participant: wordly [W] English (US)

Transcription for wordly [W]

00:00:00 [W] Thank you for joining today's session. The subject of this session is to drunk flag maker image distribution efficiently and safely.
00:00:08 [W] I'm using you from Alibaba crowd and I'm one of the containers of dragonfly today.
00:00:32 [W] Thank you for joining. Today's session. The subject of this session is to jump fly.
00:00:37 [W] make an image distribution efficiently and safely.
00:00:40 [W] I'm using you from Alibaba cloud and I'm one of the community nurse of dragonfly today. My partner Pronto will join me to share with session with you.
00:00:51 [W] First let's take a look at the agenda of this session which contains three parts?
00:00:56 [W] The first part is the introduction of the dragonfly the second part of introduce the architectures of who the dragonfly so that you can have a quick understanding of the core technical ideas of dragonfly.
00:01:09 [W] The third part will be shared by my partner control is about certain letters a miniseries, which is already a sizable project of junk blood.
00:01:21 [W] Let's get into the introduction part.
00:01:25 [W] He'll let me first try to answer what he's drunk plan.
00:01:29 [W] Champa is an open source intelligence appear to be based image and fair distribution system its goal is to tackle all distribution problems, including knative loodse knative scenarios, the core objectives
00:01:44 [W] Image and fair distribution system its goal is to tackle our distribution problems including knative loodse knative scenarios. The core objectives of the dragonfly is improved download if
00:02:00 [W] If this is the ads large skill and the reduce the pressure of source server and SQL costly bandwidth.
00:02:07 [W] We can take a look at the comparison chart on the right.
00:02:12 [W] This chart shows the time consumed patient of the downloader downloading files using knative work native mode and dragonfly mode the knative mode means that all the notes downloaded directly from the source.
00:02:26 [W] In the chart the x axis which means the number of the concurrent downloads and the y axis represent download the time the green Curve will means downloaded in knative model and the rated curve.
00:02:42 [W] the young family
00:02:44 [W] so this chart we can quickly join the following conclusion with the increase of the concurrent downloads the average download time remains fairly constant when using dragonfly
00:02:59 [W] at the same time when the skill reach high level The Source server will even go down which leads to the failure of the downloader, but it will seem dragonfly will not have this problem.
00:03:15 [W] Let's quickly pass several important important masters of junk fly.
00:03:21 [W] in 2015 in 2015 due to the internal internal needs of the Alibaba group dragonfly was born in 2017 dragonfly has undergone large-scale internal verifications
00:03:37 [W] decided to office hours in the community in a in 2018 dragonfly supported the emitter distribution and donated to the cncf foundation as image
00:03:45 [W] As they approach is here is under the since F incubating speech in the future dragonfly still has money directions to exploit and we welcome all of you to join this project.
00:03:55 [W] Currently the dragonfly Community has more than 5,200 Stars more than 70 contributors and ate some containerless from four different companies.
00:04:08 [W] are more than 50 companies are already using dragonfly including Ali Baba clouds China, mobile Billy, Billy and so on.
00:04:23 [W] Okay, you may be more interested in the car at the factor of the dragonfly design in the commentate. But next let's start the focusing on that.
00:04:37 [W] Firstly let's analyze the core of junk like peopie and City mechanism mechanism dragonfly has two components deaf cat and some not they've got is
00:04:52 [W] That needs to be installed a each node, which takes a Joe awful pier in prodyna to work including download affairs from other peers and acting as an uploader to support the other peers
00:05:04 [W] Fast from it so we know that is server said component it mainly provides this capacities first.
00:05:01 [W] It's a track hoe is a tricolor and schedule a scheduler in the peanut worker that choose appropriate downloading downloading Nats pass for each pairs each pair secretary
00:05:17 [W] also civilians server that catch download catch the downloaded data from source to avoid downloading the same first from Source repeatedly and the secretary and the celery in fact
00:05:29 [W] It's also a special pair that owns all the contents of Affairs in the peopie network.
00:05:28 [W] Another important thing is the granularity of dragonfly downloads is blocks instead of the interfere.
00:05:40 [W] It's fair will be divided into multi blocks according to the certain rules here. We can find help we have found.
00:05:49 [W] Is that the blocks currently
00:05:51 [W] I downloaded by each pair are different.
00:05:54 [W] So let's take a look quick.
00:05:56 [W] Look at jungle plus p 2 p and zebrium magnetism through a process of downloading files with lung blood first, which trigger download affairs with stronger fly at holster.
00:06:13 [W] And they have cats will send a request to the some not looking forward to obtain the scheduling results that that is which pair has which blocks after should know the
00:06:28 [W] Receives the download the request it will first check whether the field is to catch the locally.
00:06:33 [W] If not download.
00:06:36 [W] It's from the source and catch it inoculate locally.
00:06:41 [W] Then the super know that we will return the scheduling results. According to first recorded recorded relationship between the peers and blocks to the scheduling.
00:06:56 [W] an organism organism
00:07:00 [W] Devon loads of other of the Supernova that don't have any blocks of the fair the supernal that we will act as a pure node and provide other peers to download the file blocks of the scheduling results will not
00:07:15 [W] Blocks, otherwise it will only be a certain numbers of blocks default is for after the FCAT can see the scheduling results it will download the corresponding blocks from the Pierce.
00:07:18 [W] It gets the scheduling results.
00:07:12 [W] It will download the the corresponding blocks from the piers according to the scattering results.
00:07:20 [W] After downloading a block they have cats will do these things.
00:07:25 [W] First of all reported to the super nodes that it has downloaded a block and then profit profit profit is the ability to download the disk block for other peers
00:07:41 [W] Repeat the steps to 2002 almost until unknowns have downloaded the entire fair and containerd.
00:07:51 [W] Okay.
00:07:52 [W] I hope that through the above explanation.
00:07:55 [W] You have a good understanding of dragonflies core principles so far. We have been talking about the topic of fair download you may be more concerned about how to download the images through
00:08:10 [W] Nessa let's take a look at the whole chunk of Life participants in image distribution.
00:08:18 [W] Firstly we need to know when we visualize the image pull Commander what will happen according to the oci distributions back spire classification the process of putting our image around the
00:08:34 [W] to compound this
00:08:30 [W] manifest and one or more layers a manifest is a Json document which defense all their images such as layers says and digest layer is the binary form of content
00:08:46 [W] All the in the registry address ball like that has the the process of pulling our image is as follows.
00:08:52 [W] first step is to retrieve the manifesto by sending a get request.
00:09:00 [W] And the client is shoulder verifies will return the manifesto signature before fetching layers and then put layers which are not exist.
00:09:11 [W] We see that the process of downloading images is through standard HTTP request.
00:09:18 [W] This is similar to download downloading files.
00:09:22 [W] the request to download image can be downloaded through dragonfly the largest skill downloader of
00:09:30 [W] Image that can use that abilities of the dragonfly.
00:09:34 [W] So in order to meet the needs of a major distribution Channel, I added added a new compound Center they have team.
00:09:46 [W] Result of the FTM is to act as not as another project.
00:09:53 [W] Responsible for in intercepting blob Pharaoh downloaded request and calling their cat 4 PP download.
00:10:03 [W] Let's take the locker as an example.
00:10:05 [W] Are rather dark purple MH command and configured to use to use dragonfly the abdomen?
00:10:13 [W] Then download the required the layer blog fell through the dragonfly PP mechanism.
00:10:19 [W] We'll all years needed for image downloaded the will we will get complete Source image.
00:10:32 [W] At the president Jeong flag has a good practice in combination always darker and containerd E hair is the key part of their configuration of the image of the image registry project.
00:10:46 [W] In fact, as a process component deaf team is kind of almost disposable containers engines as long as download download download Fair request is for the to the abdomen the following.
00:11:00 [W] Download the logic we will be handed over to dragonfly to complete.
00:11:08 [W] Okay, at this point you have a lot about the main artifact sure architecture design and the process designer of the junk black in addition junk flag has abilities to provide more advanced
00:11:23 [W] Hit such as Network bandwidth limit Transmission in corruption and so on if you are interested in testing center, welcome to join us, okay.
00:11:27 [W] That's all that's all I have to share Nessa.
00:11:18 [W] Let's welcome Ponte to share with us about leaders immediate service. Thank you.
00:11:27 [W] Thank you, Richie. Hello, everyone.
00:11:30 [W] I am and Tower and my software is near for about group.
00:11:34 [W] I mostly work on containerd one-time-use recently years today.
00:11:39 [W] I'm going to engine is reduce the work that we have been doing the past year trying to improve dragonfly with better ways of containerd unity distribution.
00:11:50 [W] When you subject let us has been added to the Jake effect projects family.
00:11:56 [W] We are diving into details and why we do it and how it looks like.
00:12:04 [W] Before we start there's take a look at why we did it.
00:12:09 [W] Either container you go system on YouTube organization open container initiative show has OCR was created to standardize containerd image runtime and distribution to do that.
00:12:24 [W] Has defamed and me to speak. I want him speak and OT speech inspect their work.
00:12:28 [W] They work together pretty way or and help to increase the participation of the container ecosystem.
00:12:36 [W] Here we will focus on the oci image speaker in the best of the situation.
00:12:43 [W] It is right side of this slide. We have Arisen for your solution of the containerd image.
00:12:49 [W] It is consist you the Observer Json files and the day your data files. This New York rgz files are going to hinder image data layers containing all files and directories of a containerd image
00:13:04 [W] Each he is consisted of Savior Jesus and Pals and the nail your data files.
00:12:58 [W] This new your target is the files have an inner image data layers containing all files and directories of a containerd image.
00:13:06 [W] The oci image steak defines the format of each Json files and how they start changing. Their your files are to be combined to form of fascism View.
00:13:18 [W] His recent years as a containerd ecosystem Euros oci has recognized for some of the topics of the image. Speak the most important ones before we start our container
00:13:34 [W] The most important ones before we start our container we must for any country is uh to the Innovations.
00:13:44 [W] You can't a lot of delay to the containers that have had was ironically is their age even if we're only one who access a very small portion of the container in which data we still have to download the entire image.
00:14:00 [W] Another less obvious, but still important problem is that they all say I image can only support to duplication and there they are touch and they hire touches each layer.
00:14:16 [W] There are three consequences of the defect.
00:14:19 [W] The first one is The Edge if we change our files metadata it will cause the files data to be copied to the up early rains. Well II why is that evil file is modified
00:14:36 [W] There are three consequences of the defect.
00:14:39 [W] The first one is The Edge if we change our files metadata it will cause the files data to be copied to the up early rains. Well II why is that you've a file is modified
00:15:08 [W] Perhaps we'll be rooting or containerd an image you'd already served at different image layers and we have to download it. You multiple times.
00:15:17 [W] We're starting the container, even though organization asked modified that our data is actually usable for containers.
00:15:26 [W] third one is that DDT the files and directories are still safe, uh dual layers.
00:15:35 [W] And a little bit on the leader was starting a new Contender even though they want to be used by containerd and home.
00:15:44 [W] 0 CI Community operator were aware of the Joe Banks and started to talk about iot iv2 image stake for some time.
00:15:53 [W] here is a link to a shared document appear in stock.
00:16:00 [W] is happened in the Jose. I community
00:16:09 [W] besides discussing what's to be Hosea be to inspect their Community.
00:16:16 [W] The community has also seen several projects or do you think they exist in defect in different ways, for example, the dragonfly project and the Kraken project speed up image distribution of our P2P
00:16:31 [W] And he has happened in the oci community.
00:16:39 [W] Besides discussing what's to be Hosea be to inspect their community.
00:16:46 [W] The community has also seen several projects or do you think they exist in defects in different ways, for example, the dragonfly project and the Kraken project speed up image distribution VAR P 2G
00:17:22 [W] Sir me a man faces employers found able local cash to avoid downloading the entire image stay encouraged tries to solve the duplication problem with storageos with storageos are essential to Canada
00:17:37 [W] RF is Hanks the entire cheese in there out for me it and make it juicy couple to support our / iot Factory and the um, oci break unions mayor in belt saving each file or
00:17:52 [W] As a object is an image registry.
00:17:52 [W] All these are Juniors works and solve the problem The Entity most important. However, each of them suffer from different problems.
00:18:02 [W] For example, the P2P image distribution solution. Well fast still requires downloading entire image before starting or containerd.
00:18:15 [W] The filename family your local concern Romania's reduce the problem to Orange require a file to be folded under with.
00:18:24 [W] Before I person see partly it is still on - of fourth item a grody.
00:18:31 [W] Snack early July has our storage stench of the camp ability.
00:18:36 [W] That is not always available.
00:18:37 [W] cri-o FES requires of fuse 1.4 every image layer and in performance overhead with each layer, which is know if there are mainly receiver, uh,
00:18:53 [W] Valkyrie and you know say hi both suffer from the problem of too many objects for each image, which is a great burden and the image wages observing this
00:19:08 [W] And you really meant it as a Niners image service to the improve the current stage.
00:19:16 [W] With careful design that are seem each service has this key features?
00:19:22 [W] Containerd image data is downloaded. Our debug files are split into chunks at the data supports.
00:19:30 [W] can't label data deduplication. Jimmy's metadata and data are friend and Associate low intermediate layers are maintained.
00:19:41 [W] Let us also suppose enter end data integrated Jake.
00:19:46 [W] And the it is compatible with the Hosea artifacts, they Keda distribution spec, but now you to be easily integrated integrated with the existing the image distribution Deportes.
00:19:59 [W] Let's take a look at how these are done details.
00:20:05 [W] First The Spook and has a architecture at the higher level that has provides a user space file system demon as sure you need of the picture with stacking on you container that has only
00:20:20 [W] the esteemed image distribution Deportes
00:20:10 [W] Let's take a look at how these are done details.
00:20:16 [W] First this bootcamp is the architecture at the higher level that has provides a user space file system demon as sure you need of the picture with stacking on you container that has
00:20:46 [W] A very small containerd image interviewed and they are which is usually very fast the team of unfolds liberated area and expose file systems reviews to container spare fuse over heaviest particles.
00:21:01 [W] So let us can support both traditional Jean see container and virtualized containers like that cut onions.
00:21:11 [W] Because net as image committee is compatible with oci artifacts big and distribution stick.
00:21:18 [W] Is it can be a star that you know the top part which is such as well as I had voices in a collaborative environment users can choose to deploy and okey-dokey distribution Network like Jo fly between zg S 3 and the
00:21:34 [W] big
00:21:35 [W] you can be a star that you know top part which is c as well as I have OSS in a collaborative environment users can choose to deploy and okey-dokey distribution Network like Jo fly between zg S 3 and the
00:22:05 [W] To further accelerate image data to stability in large-scale.
00:22:10 [W] He said metaschema and optional be local Cache can save image G tab image data locally to put some future date I exits.
00:22:25 [W] And as a call operators, if you desires an image format to support all these key features, each container image is divided into a metadata layer and the data layer
00:22:40 [W] In that is a vertical tree also known as a hash tree data structure.
00:22:46 [W] Every file and directory is a hash table the industry with these hashtags history calculated either by straight up or biased is Opa is descendants in the case of a direction
00:23:01 [W] verify hope file or differences
00:23:01 [W] I recalculated your stages.
00:23:04 [W] Each fails did how is cutting to fix ourselves a chance?
00:23:09 [W] Each character has his own passionate.
00:23:13 [W] hashtag just calculate area based data safely in this year is a new year.
00:23:19 [W] Because they're different they are you separated from it has a year.
00:23:23 [W] let us can represent container image versus view just with the metadata layer.
00:23:30 [W] And as it is and they are can be shared among different communities and layers and the entered data check label Susie agencyiq.
00:23:39 [W] They are shared between different container images with this chapter. It had a cheery Global check naval data deduplication is possible as well.
00:23:56 [W] After learning about the lettuce image for made this look at how it can benefit us.
00:24:03 [W] The immediate benefit is that we can touch containers much faster.
00:24:10 [W] In a container startup startup time Benchmark, we measure this Edge the conversational containers that have had can be proportional to the size of container. You jeez. For example, OBD
00:24:25 [W] Very quickly since each image is pretty small.
00:24:26 [W] However for that image that tensorflow you should take several minutes to start.
00:24:34 [W] And all animals of the hell is but I'm putting the hunter image.
00:24:41 [W] However with will running with letters we can see that they contain reimage the container is critical and in our startup panel is pretty consistent or below 4 seconds.
00:24:56 [W] And I added a part of the graph we can see that that has always finishes couldn't cut in our image in this area and one secret sex to the image format design.
00:25:07 [W] are separate image data and the metadata.
00:25:15 [W] Another very useful benefit brought bananas.
00:25:21 [W] He's entered data integrated with conventional computer images images are downloaded at the very fat and image layer.
00:25:34 [W] Then it is Comfort are compressed to a local fire season. After that we can dodge know if it is changed change the intentionally or unintentionally.
00:25:45 [W] This father's not some downloading applications for a long time because these cranial is a decided to data in crop. She cannot be anticipated.
00:25:41 [W] However, let us can be configured to always check image data chicks are before returning you to container applications. Then usually ensures that whatever be read by the containerd application is
00:25:56 [W] Because he isn't.
00:25:50 [W] You leave even if there are user disk failure or silent silent data corruption, it can detect that and as we sort resort to Jesus for the original copy of data.
00:26:08 [W] There are more benefits of learning that has image service that we do but cover here we have open source for you to answer sub-project of dragonfly.
00:26:17 [W] We carry each the audience to check it out and argued happen with policy.
00:26:24 [W] You future we plan to introduce paid her integration with second container image ecosystem such as integration with beauty k8s HR.
00:26:35 [W] We want to support more data compression opposite averages are as we are going to do only are they foreign supported and we are looking at it flexible check sets and for example debilitation devils.
00:26:50 [W] Last but not least. We were proposed to the oci community to knative let us serve as jfrog zebrium ventilation implementation to the oci B2B image steak.
00:27:07 [W] OK we have finished the Jose a third option.
00:27:10 [W] Thanks for watching.
00:27:11 [W] The Twitter handle a didn't talk group.
00:27:11 [W] Please feel free to contact us.
00:27:13 [W] She a method you prefer and we can answer questions in the queue a sec. Thank you.
00:28:28 [W] Yes, our body image signing where you we do have plans for you, too.
00:28:33 [W] And right now what is done with notaries was really for image signing during their distribution phase and the production phase and as well, but
00:28:48 [W] Burned for the occurred siding procedure because what you for, uh, it's additional Jose images downloaded locally and unpacked the signature cannot be verified again.
00:28:53 [W] No, Cody and unpacked the signature cannot be verified again.
00:28:59 [W] So where's Wes let us where we were planning to and image image signature and they are in the Manifest and then we can we have to
00:29:14 [W] Can we had to our lab runtime signing verification because we when we do for you can verify them benefits that we can verify them that us mayadata.
00:29:29 [W] a geneticist metadata layer is a is self self certificate bow because sales F5 era fiber with this type has three design so
00:29:45 [W] Zero verification chain can you can be expanded to the runtime so we can make sure that anything we return to the container is actually
00:29:57 [W] the image producer
00:30:12 [W] you have four difference between Jennifer and crankin cane.
00:30:20 [W] Using can you hear Karen there?
00:32:10 [W] Okay for help from my understanding Jennifer and crankin a very silly nerve to to the pointers and they solve their problem
00:32:39 [W] okay, I don't follow how far my understanding Jennifer and crankin are very Savvy nerve to to the
00:32:55 [W] General Frye hands are super loaded and the period of the architecture and crankin is more like a pure cement symmetric
00:33:10 [W] So in the core of the crank on the P2P and they they don't have a something like a super nodes are all these nodes are even to each other.
00:33:23 [W] So there's architecture difference and but other than that, they share a lot of income Mike I think.
00:34:10 [W] Oui.
00:34:18 [W] I don't know how long this is taking please.
00:34:20 [W] feel free to ask questions in the room.
00:34:26 [W] We have the boat.
00:34:47 [W] In you for your help. We don't have further questions.
00:34:52 [W] I'd like to thank you for all the audience and you can give you four have any additional questions.
00:35:01 [W] You can join their step Channel and the web is there to answer them.
00:35:05 [W] as well
