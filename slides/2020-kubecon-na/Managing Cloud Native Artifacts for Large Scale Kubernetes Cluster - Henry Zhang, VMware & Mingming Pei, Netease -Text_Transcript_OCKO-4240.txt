Managing Cloud Native Artifacts for Large Scale Kubernetes Cluster: OCKO-4240 - events@cncf.io - Friday, November 20, 2020 5:57 PM - 22 minutes

Participant: wordly [W] English (US)

Transcription for wordly [W]

00:00:00 [W] Hello everyone.
00:00:02 [W] Welcome to our session managing cloudevents defects for large-scale kubernative casters.
00:00:09 [W] And maintainer of Harbor my interest is in cloud computing AI machine learning and blockchain today with me is minglang. Pay architect from Nettie's.
00:00:23 [W] He's responsible for Ching Joker knative that of perform.
00:00:27 [W] He's also a harbor maintainer.
00:00:33 [W] Here is today's agenda. We first talked about the two aspects of managing Cloud native applications.
00:00:40 [W] Then we introduce how to use harbor to manage Cloud native artifacts next.
00:00:47 [W] We will go through the case study of net East High and how they manage artifacts for large-scale kubernative cluster using Harbor.
00:01:00 [W] We all know that grounded Technologies become increasingly important to feel modern applications.
00:01:08 [W] Usually there are two aspects in managing cognitive applications.
00:01:12 [W] The first is the dynamic part.
00:01:16 [W] That is the runtime how the applications run and how they are scaled up monitored data and so on.
00:01:25 [W] Then we introduce how to use harbor to manage Cloud native artifacts. Next we will go through the case study of Nettie's high and how they manage artifacts for large-scale kubernative cluster
00:03:43 [W] artifacts
00:03:46 [W] the most common and important cognitive artifacts container images Helm trusts and so on the usually that would be more like see nerve and so on to be managed in a cognitive environment
00:04:03 [W] given the importance of artifacts we need to efficiently and securely manage artifacts when operating a cloud native platform and however, a graduated cncf project is designed to perform the tasks
00:04:19 [W] Jean-Claude knative artifacts. It supports oci artifacts like Docker image Helm Charles seen apps open policy agent singularities and so on in
00:04:34 [W] Have a provides a bunch of features on artifacts management such as our back role-based Access Control in which isolation by Project image retention in and immutable images.
00:04:45 [W] We will cover some of them shortly.
00:04:51 [W] The first artifact management feature. I'd like to talk about is rapid creation.
00:04:57 [W] This feature was created in Harvest early version 0.38 allows to Harbor instances to synchronize the images from one to the other.
00:05:10 [W] Because the replication tasks are carried out automatically and reliably users love and apply this feature in many scenarios.
00:05:20 [W] In the latest release of Harbor it can support replications of artifacts across multiple Cloud environment with various registry and services.
00:05:32 [W] We list some Refugee service here such as Docker Hub Refugee service in public cloud like AWS Google Azure article and so on.
00:05:42 [W] It is very simple to move your artifacts between different environments.
00:05:47 [W] This will help a lot when managing your artifacts.
00:05:51 [W] Just release some British service here such a stalker Hub Refugee service in public cloud like AWS Google Azure article and so on.
00:06:01 [W] It is very simple to move your artifacts between different environments. This will help a lot when managing your artifacts.
00:06:13 [W] Suppose you're running a large cluster with many notes. If all those crew image from the public registry Services. It will take up a lot of networking bandwidth to download the same images again. And again, it is obvious
00:06:30 [W] From the public registry Services, it would take up a lot of networking bandwidth to download the same images again. And again, it is obvious not optimal more not all nodes within
00:06:47 [W] ultimate
00:06:48 [W] more not all nodes within an organization's allowed to connect to the external registry.
00:06:55 [W] So have a provides a feature called proxy cash.
00:06:59 [W] This feature has been requested by many Community users for quite some time.
00:07:05 [W] It is released in Harbor 2.1 recently.
00:07:10 [W] It is a special kind of Harbor project which can hold catch the images as serve them locally.
00:07:17 [W] It's safe external networking bandwidth and speed up the local distribution of images.
00:07:24 [W] Under the hood in leveraging replication can ability of Harbor to pull images from remote sources when they are not available locally.
00:07:34 [W] Because cash the image are store under Harbor project all the project related features in Harbor such as quota scanning immutable Tech can all be applied to cached images.
00:07:52 [W] For any religious service in production High availability and scalability must be considered. There are many ways to achieve haproxy registry service.
00:08:03 [W] I just reached reduce some principles here, which can be the guidelines for users to implement a production registry.
00:08:14 [W] the harbor core services
00:08:16 [W] Instances of each component the key here is to set up haproxy systems services like postgres SQL radish and shared storage.
00:08:28 [W] There are many existing solutions for these a chaser Services.
00:08:33 [W] just through one of them that fits your environment.
00:08:40 [W] If you have multiple data centers or cloudy - that running your applications, you can establish Har-Ber instance in each Data Center and environment so that they can back up each other the replication
00:08:55 [W] The center's or cloudy - that's running your applications.
00:08:49 [W] You can establish Har-Ber instance in each Data Center and environment so that they can back up each other.
00:08:57 [W] The replication policy can be configured to synchronized artifacts between two environments also postgres Cisco and radish can be kept in sync by using some kind of synchronization.
00:09:12 [W] So postgres SQL and radish can be kept in sync by using some kind of synchronization software or mechanism.
00:09:24 [W] By adding load balancers in front of Harbor Services it provides High availability with an active standby configuration across two environments.
00:09:34 [W] This creates additional protection for refugees service, if one data center or one environment goes down. The other can go live to continue the service.
00:09:47 [W] One thing to know is that the propagation delay our artifact replication between two data centers or to you - should be taken into consideration and when implementing such a solution that is to say
00:10:02 [W] Into datastax hers could be different when artifacts are being replicated.
00:10:09 [W] When artifacts are deleted from a registry, there are storage space need to be released and reclaimed.
00:10:16 [W] This process is called garbage collection system administrators should perform garbage collection periodically to ensure the system does not renounce of storage space.
00:10:30 [W] in the latest Harbor 2.1 release garbage collection feature is improved and can be performed without any impact of image pushing pulling and deletion this feature allows Harbor to keep
00:10:45 [W] Service while doing backhand garbage can clean up.
00:10:41 [W] This is very crucial for a production system to be up and running continuously.
00:10:52 [W] When publishing a new version of the application to a Caster we need to send artifacts to every note for a large-scale kubernative cluster.
00:11:03 [W] It is a challenging task to distribute artifacts to all nodes within a short time frame.
00:11:10 [W] If there's only one registry instance servicing the entire cluster the registry instantly become the becomes the bottleneck of the distribution.
00:11:22 [W] So the address this distribution problem in enlarged Caster peer-to-peer distribution disputes disputing approach seems a feasible solution Harbor can leverage the capabilities of petabyte-scale trance-like dragonfly
00:11:37 [W] to accelerate artifacts distribution
00:11:34 [W] What have a does is to preheat a P2P Network or one of the cluster the idea is to distribute artifacts to the P2P Network before the request of the artifacts arrived.
00:11:48 [W] When the actual request comes in the content is ready for distribution within the PW Network and can be transferred right away.
00:11:57 [W] In a case study of net East we can see that the P2P approach improves performance significantly in a large cluster of many kubernative notes.
00:12:11 [W] Harbor can will be multiple kubernative casters as well by setting up proper preheating policies Harbor Care Center artifice to each petabyte-scale a stir and make them ready for subsequent artifact distribution.
00:12:32 [W] When administrator manage artifacts security is one thing they need to deal with Harbor can help scan the content against the publicly known CBE databases based on the scanning result have a
00:12:47 [W] Is found in the artifacts so that administrators can take proper action such as patching the image to remediate the vulnerability.
00:12:46 [W] This is not only crucial in a production environment.
00:12:49 [W] It can be use in seei pipeline during development phases to ensure all images created do not contain severe vulnerability.
00:13:04 [W] In addition to one durability scanning Harbor can block pool requests if the image vulnerability exists a certain threshold level.
00:13:15 [W] Are so out of features like content trust can ensure a provenance of the artifacts and one of these gaining can be triggered automatically when an artifact has been pushed to the registry if
00:13:30 [W] Gbes to exist in the images for example is the matter if they are not very critical or if you know, it is critical, but you want to make them available for a while in your Enterprise or in your organization's you can
00:13:33 [W] in the allow list
00:13:29 [W] from time to time user made them to have their own types of artifacts if these artifacts follow the oci specs, they can be managed and visualized by Harbor.
00:13:40 [W] the latest version of Harbor extend the functionality for artifacts processor
00:13:47 [W] users can Define their own artifacts format and media types by following the oci specs. Then the artifacts can be pushed to or food from Harbor.
00:14:00 [W] a benefit of storing artifacts in Harbor is that
00:14:05 [W] artifacts can be treated the same as container images and can be replicated to other places or enforced by role-based Access Control.
00:14:17 [W] And you also get our other features free from using Harbor.
00:14:23 [W] We have already seen Partners utilizing Harbor for storing machine learning models as artifacts and reduced operational capacities.
00:14:34 [W] There are many more to talk about how this capability of our divest management, but I'd like to pass it to Maine, Maine for sharing his experience in artifact Management in Nats least.
00:14:47 [W] Today, I will introduce how we manage it at actors in A Taste. Now that our container technology is widely used in the eighties. We use contain images term chart
00:15:01 [W] as our factors
00:14:53 [W] gitops is also used in production and we use have as our repository of cognitive at the factors.
00:15:03 [W] And now there are lots of communities clusters in netis and five thousand-plus nose in larger ones.
00:15:14 [W] more than 20 have instances and largest have assistants managers about 100,000 images.
00:15:23 [W] is
00:15:26 [W] let's take a look at our architecture.
00:15:30 [W] We developed ER to services to manage the harbor instance is and the communities clusters and we have the flexibility to combine the relationships of
00:15:45 [W] At the same time accessing them by the authority system of net is cognitive at form as being established in addition.
00:15:53 [W] We integrated our notice object storage has beckoned for high availability and high performance.
00:16:07 [W] How do we make Harbor highly available in essays and first we address Harbors High availability of five star which includes objective storage and
00:16:22 [W] We use I think you know a fire synchronous tool to synchronize the dead when using log fire system for external Lee dependent ER highly highly available.
00:16:28 [W] Leti we have to start the open source project Stalin to adjust the high availability of postgres Telco and the haproxy approach to address the
00:16:38 [W] T of variance which you can find a detailed description in Harbor community in addition have as monitoring many arms at our scene is enhanced and
00:16:51 [W] The monetary clamps of Sir since such as replication failure and P2P dispatching failure achieved through Matrix of plume. Messiest.
00:17:07 [W] this is how we approach these are multi environment management management of other factors first to packaging and completed all kinds of tests in the test environment and
00:17:22 [W] Please Release to chica remote replication the image will be replicated to Czar production environment and the intrigues of online Department.
00:17:43 [W] for larger scale distribution of the images we are facing two problems are one is the throughput
00:17:55 [W] Play something registry service and next is Network tan wires pressure in back-end storage, and we realized petabyte-scale scription by integrating.
00:18:10 [W] Integrate in integrating have and Cloud Solutions are mode of selling registry server.
00:18:13 [W] The completed design can be found in their community of cracker.
00:18:19 [W] We finally achieved the growth of over 5,000 concurrent process and 10 gigabytes Plus image distribution acceleration.
00:18:33 [W] And here I would like to introduce some features of people kid is to butan of clock on this is tested.
00:18:43 [W] We met you can see from the table.
00:18:51 [W] The band The bandwidth limit of Kudo key distribution is comparable and from tab I can see my layers and smaller layer sighs cause lower UT UT utilize utilization
00:19:06 [W] It's a nice-sized our distribution will be slower. And the number of peopie peers brings the time factor to their distribution performance Max 15 kilos
00:19:13 [W] Opportunity and it works well in our production environment now.
00:19:11 [W] We also pay attention to the safety of other factors other factors are scanned after packet admitted immediately.
00:19:22 [W] There are also two types of quality gets the pipeline get and the dispatch get a laws are set and they will be goes to loot to determine whether that are factors should be
00:19:37 [W] It from being used in production environment.
00:19:41 [W] And finally, let's look at how we manage it there other factors in ci/cd first, we create our ci/cd process with
00:19:56 [W] Look at how we manage it there other factors in ci/cd first, we create our ci/cd process with application Cynthia. You can see the flow flow of our
00:20:22 [W] You can see the full flow of our ci/cd.
00:20:25 [W] And also I have excused some related processes earlier and besides that we following functions are also contained in ci/cd s
00:20:41 [W] Artifacts are blessed management artifacts gritty and CD triggered by image of pushing webhook.
00:20:50 [W] Ci/cd stages are connected in serious slow could and the factors.
00:20:59 [W] okay, you see from this is picture and this is the for ci/cd flow in our company and that's
00:21:11 [W] Of my shell.
00:21:13 [W] Thank you Doctor Who convention?
00:21:18 [W] Since meaning I want to summarize a little bit here.
00:21:21 [W] So artifact management is an important aspect of operations in a cloud native environment registry is an ideal place for performing the management tasks of artifacts
00:21:36 [W] our choice over powerful tools for managing your attic Fest Harbor can provide High availability and scalability for a refugee service and camera application proxy cashiering lump rocking juicy and so on a whole
00:21:46 [W] Powerful features that you can consider and leverage as you can see the case study of lenses.
00:21:43 [W] They use harbor for the large-scale kubernative cluster in the for the artifacts management. Lastly.
00:21:51 [W] I wanted to introduce our new book of Harbor. It is the first book on Harbor in the world. Also by the Harbor's maintainer and contributors if you are interested in the content, please take a look.
00:22:06 [W] Thanks for listening to our session.
