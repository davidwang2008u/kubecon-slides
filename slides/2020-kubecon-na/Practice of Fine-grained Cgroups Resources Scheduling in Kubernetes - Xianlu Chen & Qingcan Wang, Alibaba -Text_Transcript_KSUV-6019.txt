Practice of Fine-grained Cgroups Resources Scheduling in Kubernetes: KSUV-6019 - events@cncf.io - Thursday, November 19, 2020 5:42 PM - 37 minutes

Participant: wordly [W] English (US)

Transcription for wordly [W]

00:00:00 [W] Hello everyone.
00:00:02 [W] I'm seeing someone from Alabama Cloud.
00:00:05 [W] You also can call me Alex won.
00:00:08 [W] Thanks for your attention.
00:00:10 [W] Hello everyone. My name is Kenya before Mara Bob McLeod three man called anything and I will talk about the practice of cgroup resource scheduling in communities environment here.
00:00:22 [W] Our bin is nereo such as database service many other instance you to dynamically increase the resource limitation during operations and account except very impact of polystar. Then we need to develop a service to configure cgroup for the payload
00:00:38 [W] Multiplication is rest on the bare metal instance and ovhcloud and as image the mountain Numa performance problem.
00:00:36 [W] The application is required Numa awareness.
00:00:39 [W] If you compounding reduce the Disco be between civil case and speed up the data processing tasks.
00:00:46 [W] have developed a combined schedule Nats system based on kubenetes scheduler framework and cgroup controllers. The scheduler perceive the cgroup never resource such as Numa.
00:00:59 [W] If your car memory limit and our past scheduler Dynamic scheduling to Sebastian says no well allowing certain pose is bound to the specifics. If you call the SQL controller can also dynamically adjust the police
00:01:14 [W] Coughing the pilot. Who is that?
00:01:12 [W] Okay, this is a general today's Topic in the first part.
00:01:16 [W] I will introduce our purchase of cgroup resource means management.
00:01:22 [W] Then my college children will talk about the CPU scheduling based on schedule framework also about some other related works.
00:01:32 [W] As we know that she go is our implementation to limited resource for the process and is a basic ability in-toto container with cgroup. We can say the limitation for number of the source then process group can use
00:01:48 [W] Has the power to control of the process group also it can cause the number of the source used by the process group in our products including his environment to the base is e sense is deployed
00:01:54 [W] Using configurations in containerd a were for the resource limitation was it is not enough first.
00:01:50 [W] We can only configure the CPU or memory is the continuous back Temptation for the story is not accessible supported.
00:01:56 [W] Secondly the limitation is that who is the continuous statue and cannot be changed when the cleaner is Islamic State? Also, the limitation is only configured for the containerless and not fall apart.
00:02:08 [W] So when you develop a service that can Dynamic operator
00:02:13 [W] cgroup limitation both foil container and pole without a pillow the restart and with a single smart controller resource limitation can automatically configured by some cgroup policy.
00:02:28 [W] Sig Okinawa is developed for this purpose from the perspective of a function with a single controller. We can't Dynamic configuration cgroup limitation.
00:02:37 [W] With great equipment is resource and you not need to care about the poor location and a learning environment from the perspective of the elevation. The SQL controller is a realization of the societies for cgroup and cgroup policy.
00:02:52 [W] It was the idea the controller Dynamic configure the SQL imitation photography sauce and a payload and the SQL policy makes the policy to automatically adjust cgroup sisters limitation Which cgroup smart controller
00:03:05 [W] Great, he starts use it.
00:02:54 [W] We just Mash resource allocations cgroup controller. Also a supposed of all supposed to configure different payload includes development server said Jimmy said Paul if the limitation is says who the deployment
00:03:09 [W] Also be configured.
00:03:11 [W] We single controller we can configure that you can interpret half of our sauce for the limitation.
00:03:16 [W] You crossed a few sheep. You said memory and a pure cacao Community is can only is there a limitation for Cardinal Ava has you controller supposed to says the limitation imposed for and containers who is producers
00:03:31 [W] kissing post Pro part and a continuous way the positives of limitation all containerless unipolar World said of those thoughts and Keda limitation this time sharing business the sedimentation in the Park River can improve the sociology
00:03:43 [W] - the sedimentation in a part never came home. The sociology cri-o can be supposed instable Constable controller, but block give us real complex because there are in more than one device
00:03:59 [W] Be more than one device you want know? So how do you find the practice is important civil control us about 5500 block device with multi mode such as could have has volumes device ID.
00:04:12 [W] So that is V DX and DV path.
00:04:17 [W] Now let's talk about Improvement of SQL controller first for the definition of reality.
00:04:24 [W] It is defined as the source details for resource belong to which node the type of resource and the resource ID.
00:04:32 [W] For example, we can define a why you chose as the building our own limitations for the little FS of another one.
00:04:38 [W] study also defines the target payload including development still says give me said on Port and
00:04:47 [W] So near to point out is that Target apart and Target economy also a society. You can record the stress limitation status with it.
00:04:55 [W] The controller can check the limitation stating is complete Community communities or not.
00:05:01 [W] Next.
00:05:03 [W] Let's check Telco value the main process single controller will select SQL Saturday is from the API server. And if the new SQL of objects is created the controller we are guest is and pass the parameters the componentconfig.
00:05:16 [W] Solar will check the payload.
00:05:18 [W] for example the development of course and get the target node ID and containerd information and the first step is the controller will create a job by the Accuser.
00:05:29 [W] Probably notice the quit his job is configured with targeted payload and imitation calculations. It's all good job harder will get the stick will pass and the target container of apis and then it says limitation
00:05:45 [W] Having to pass file also the to apologize because the limitation setting status to the cell which can point out the SQL limitation setting is accessible or fear.
00:05:44 [W] Next let's look at some examples.
00:05:46 [W] The first one is to say CPU and memory for example namely supposed to feel.
00:05:53 [W] We should consider Community immigrants to the Pod and also we can configure the CPU and memory limitation and the same time the second one and the third one is setting the table set for development or
00:06:08 [W] Part, where should configure the targeted content name for that?
00:06:09 [W] The first jump template is it means that they are cri-o for the block device.
00:06:14 [W] You can save the device read or write BPS or device read or write out PS4 one device as mentioned before the target device can be defined as little effort as a volumes or device ID
00:06:29 [W] In this example, we sell to the Kudo FS.
00:06:29 [W] Above we have used a single controller design and implementation.
00:06:34 [W] You can finally the Sickle Cell Gene is only to configure the seek the cgroup limitations for different payloads.
00:06:42 [W] It is automatic but not smart.
00:06:45 [W] smart here. We add a new study animal cgroup policy to define the cgroup cgroup allocates policy for a special resource the SQL plus you can supposed
00:06:55 [W] That's bad resource limit locations policy, which makes us resource limitation average between the pillows work on the results.
00:07:04 [W] Society can Define the target resource including Target node type of resource type track the source ID which is neuticle defined defined in the class.
00:07:14 [W] Also, the study can Define the Total Resource limitation threshold.
00:07:18 [W] For example, the total a PS4 the block devices of all the percentage of CPU or memory for once best phase node.
00:07:27 [W] Also, just like the cgroup ci/cd the cgroup policy should record the problem station on the target resource.
00:07:35 [W] He's a status field. We can shows you the limitations details on wine sauce.
00:07:40 [W] Next let's talk about the main process the cgroup policy in place inflated the ci/cd logic for the cgroup policy.
00:07:49 [W] However, in the controller if an apology is added or removed from the target stick with Paula Siege, it will create us cgroup objects there.
00:07:57 [W] To attach to the first limitation for the different payload, for example, if a set of hold the lead his Hawaiian cgroup policy increased from the number of tool to switch the new resource limitation is repellents the folder for all
00:08:12 [W] And the cgroup SQL object is quite hero to configure the new empty scene for the safe house step. Three is the controller we are watch the states has equated cgroup object and operator Setters and the related Paul
00:08:15 [W] object
00:08:12 [W] let's look at an example for the cgroup policy is a big obstacle for Sig template which if and the thousand-dollar information with the no selector, which you can't Define a wine odor or more notes, you know Christ.
00:08:26 [W] Also we Define another source type because our Dean's then we can identify the unique oil sauce in cast
00:08:32 [W] When you start type is defined as the cri-o source, IPS limit can be defined a to the Target device total obvious limited value.
00:08:41 [W] And if there is just type is CPU or memory that is also a few percentage or resource. Memory percentage can be D configured and the first policy field is defined the resource limitation policy.
00:08:55 [W] You can configure is the speed which means the same limitation will be configured between giving
00:09:02 [W] No as soon as possible.
00:09:04 [W] Also, you just said something called a status shows the status of one resource limitation.
00:09:10 [W] He buries actions the processing value means the website strawberry is easier process and you better job cannot be started immediately. The payload field shows the results limitation settings and you can
00:09:25 [W] roxanna's as limitations details of the
00:09:28 [W] You want so if you want to enable the resource immigration policy for the special space o payload the SQL policy. Define defies definition should be added to the pillow the notations cut slices, for example.
00:09:44 [W] Poor the total cgroup Toda. Raba culture comes as when policy object then the Civil controller. We are kaiser configurations and to the source limit balance.
00:09:57 [W] Below is an example of when Paul is the payload which is configured to build our PS type cgroup policy.
00:10:04 [W] We find that we find that the post option is you changed over time.
00:10:10 [W] Okay is above is about to the SQL service management topic and below. My colleges Kingston will bring the topic of CPU scheduling based on schedule framework this worker.
00:10:23 [W] Next I will introduce control CPU scheduling based on scheduling framework.
00:10:32 [W] First of all, this picture shows the simple topology of the multi-core machine that we use more frequently and present.
00:10:43 [W] Th level 1 or level 2 cache this Theory fraud throughout private Cache.
00:10:38 [W] No other call can override the level 3 is shared between calls cpos belonging to different Newman nodes to access different parts of memory at different speeds
00:10:54 [W] Three are the shared between calls scipios belonging to different Newman nodes to access different parts of memory at different speeds
00:11:18 [W] Holmes is cracked heuristics.
00:11:20 [W] We think it is necessary to find CPU scheduling workloads one to reduce. The program loss caused by frequent switching between multiple calls to to
00:11:35 [W] Kyle's / frequent switching between different Newman nodes third to select the pastor CPU scheduling result in clouds third dimension.
00:11:51 [W] This is our complete architecture.
00:11:54 [W] We have three extension components first CPU scheduling plugins based on scheduling framework second cgroup controller.
00:12:07 [W] It is responsible for cgroup operation. This is
00:12:12 [W] Mentioned in previous part Third Secret Agent 18 responsible for reporting the CPU topology and the real sip shoe.
00:12:25 [W] reload of six you
00:12:28 [W] this will be used in scheduling decisions a process is like this. So the type one.
00:12:37 [W] When we add to a new node linkerd mirantis cluster cgroup reagent will report the topology to a pastoral stop to could be schedule will change the port creation wind step 3 scheduling
00:12:53 [W] Made according to the algorithm step for could be schedule will create cgroup cri-o fossil fuel cells step 5 cgroup controller will change the cgroup CR creation event.
00:13:05 [W] Six cgroup controller creates jobs for cgroup Scipio setup relation step 7 the job will complete the CPU bounding operation.
00:13:08 [W] Our CPU scheduling is based on schedule in Freiburg the scheduling framework.
00:13:14 [W] It proposed neo-realist 1.15 and either expected to graduated in release 1.20. We have implemented the following our
00:13:29 [W] Apropos to you realist 1.15 and is they're expected to graduated in released 1.20. We have implemented the following our following
00:13:50 [W] shrimp Owens
00:13:54 [W] Felton futurewei figure out the notes that counts meet the requirements of the Provost appeals Segal cigar will slagter optimal CPU scheduling result by
00:14:09 [W] result result will first results are optimal CPU scheduling results to prevent reallocation to as the polls and each will clean the CPU scheduling
00:14:24 [W] India across the embalming cycle
00:14:24 [W] post back post divider will creates a pulse SQL cri-o
00:14:37 [W] our scheduling algorithm is mainly divided into two parts.
00:14:42 [W] This is the first part Newman node selection. Your top priority is the CPU core should be assigned to a single new methods to prevent the loss caused by frequent switching
00:14:58 [W] In Newman notes is a frosting to pay attention to as shown in the picture.
00:15:04 [W] We will choose Newman Node 1 in version 1 and a new bundle of for emotion to instead of other new models if multiple new man knows meet condition 1 Z will be
00:15:19 [W] In the real secure logs, the real Superior loads are reported by secret agent.
00:15:21 [W] If or SQL Newman note card image in the news should be eating of single socket.
00:15:31 [W] Then the second part is course selection.
00:15:36 [W] Here we have two policies the first one a try to make a side processors belong to the same call.
00:15:50 [W] Then we will share the level 1 and level 2 cache as shown in the picture.
00:15:56 [W] We will choose new menudo one of three instead of two.
00:16:01 [W] The second one is to try to choose the relatively idle human nodes as shown in the picture new model. The three is better than one.
00:16:15 [W] Next I will introduce our results under different workloads for Scipio sensitive. Java Computing workloads time will be reduced by 20% for CPU sensitive
00:16:30 [W] Relatively Idol Newman notes as showing in a picture Newman notice three at the patterns that one.
00:16:38 [W] Next I will introduce our results under different workloads for Scipio sensitive. Java Computing workloads time will be reduced by 20% for CPU sensitive
00:17:08 [W] Education kill psvr increased by 20% to 30% on average the following picture shows the trend for my so-called workloads.
00:17:34 [W] For video transcoding workloads.
00:17:38 [W] We choose to convert MPGs for to h.264 with different size and a concrete see
00:17:52 [W] the cast of the results shown
00:17:55 [W] in the picture below about 10% efficiency Improvement.
00:18:04 [W] Because the result of scheduling is optimal result.
00:18:10 [W] that is a moment of poached creation as shown in the first picture due to limited resources.
00:18:17 [W] Some poles are allocated scipios across new models after a period of 10 the CPUs allocated by potent what pulled a
00:18:30 [W] H shoes six for with different size and a concrete see
00:18:37 [W] The tester is out should.
00:18:41 [W] In the picture below about 10% efficiency Improvement.
00:18:50 [W] Because the result of scheduling is optimal result that is a moment of poached creation as shown in the first picture due to limited resources.
00:19:02 [W] Some poles are allocated superiors across new models after a period of 10 the CPUs allocated by potent what pulled a
00:19:15 [W] I released pull the be can be allocated from the single Newman note. The schedule will create a new cgroup CR. It is not about modifying the original
00:20:41 [W] is not about modifying the original the purple C troop free with prevent later conflicts interact modification Seagal in framework will watch the event
00:20:56 [W] We'll watch the event to update through the scheduling cash in case of data in constant C.
00:21:05 [W] the original original date of schedule shall Prevail finally cgroup controller are the just pulled be to the single Newman note in this the way
00:21:20 [W] Holly and Chester sip yourself to achieve better results
00:21:27 [W] Finally, I will introduce other related work that we are working on.
00:21:37 [W] In order to better manage scheduling related plugins a new project scheduler plugins is created a tool.
00:21:48 [W] For the lated users to manage different plugins users. Can Define their own plugins directly based on this project?
00:22:00 [W] We have a completed all I implementing the following plugins course scheduling also we can call Gun scheduling capacity scheduling notary Source allocatable
00:22:15 [W] We're scheduling your link is below if you are interested, you can learn more about it.
00:22:20 [W] Our future work is mainly divided into two parts.
00:22:24 [W] The frost is make spok from batter on kubernative.
00:22:28 [W] We will enhance their scheduling to meet your needs of the spok added some time.
00:22:35 [W] We will also carry out later acceleration work.
00:22:41 [W] The second is heterogeneous resources scheduling like chip seal technology scheduling.
00:22:51 [W] Okay, that's all about how Pataki SEC you for listening. If you are interested contact us by email or slack.
00:23:01 [W] Thank you so much.
00:37:02 [W] mama
