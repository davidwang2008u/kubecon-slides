Introduction to Data Protection WG in Kubernetes: UUCU-4957 - events@cncf.io - Tuesday, August 18, 2020 8:28 AM - 70 minutes

Participant: wordly [W] English (US)

Transcription for wordly [W]

00:01:27 [W] Hello everyone today shantia, and I will give an introduction to the data Protection work group in communities.
00:01:35 [W] My name is Chang. I work at VMware in cloud storage team.
00:01:45 [W] I'm a co-chair of kubernative 6 storageos.
00:01:50 [W] Hello, this is John Chen. I'm a software engineer from Google.
00:01:59 [W] I work with the shin within this working group.
00:01:59 [W] So here is today's agenda first.
00:02:11 [W] We will talk about why we are forming this depression Will Group who are involved.
00:02:19 [W] We will talk about the charter the data protection definition what other existing building blocks in communities and what are still missing what we have been working on and finally we'll talk about how to get
00:02:29 [W] involved
00:02:30 [W] In in kubernative the state of applications use persistent volumes to store their data.
00:02:47 [W] Under an underline.
00:03:01 [W] So the system even if the part goes away, however, what if the what if the underlying story system is stricken by a disaster?
00:03:14 [W] What if the volume under stress system gets corrupted. For some reason when that happens even data stored on the persistent volumes will become so to prevent data loss for happening.
00:03:25 [W] We need to find a way to protect the data stored in the
00:03:28 [W] In volumes used by because the kubernative stay for applications.
00:03:36 [W] Although how to provision persistent volumes is why known it is still a challenge to protect your workloads in communities. This is a problem that at this data protection Will Group wants to solve
00:03:46 [W] in kubernative voting snapshot was introduced as other feature in 2012 and was promoted to Beta in Windows NT release.
00:04:04 [W] This allows us to backup and restore a volume based on voting snapshots.
00:04:09 [W] However, many things are still missing at Cube car in San Diego at the end of last year.
00:04:18 [W] There were several sessions in storage for ACT talkin about data protection in kubenetes. We also had a meeting with the zettabytes.
00:04:22 [W] In communities voting snapshot was introduced as other feature in 2012 and was promoted to Beta in when the 17 release this allows us to backup and restore a volume based on what in snyk shots.
00:04:28 [W] Reached a consensus that a dedicated work group should be formed to focus on this area.
00:04:37 [W] We got support from six or chair subtly and C caps chair and mmm we sent out an email in kubernative Stephanie list and got an overwhelming response has so we formally
00:04:48 [W] PR is shown here to form this one group. It was approved by the steering committee in January.
00:04:57 [W] So the group was formally established.
00:05:01 [W] We have been holding bi-weekly meetings since then.
00:05:03 [W] As shown on this slide, there are many companies have been supporting the swine group.
00:05:19 [W] And this is the chatter of the data Protection work group. We have this listed on our wing groups Community page this when group is formed so that we can have a crust Sig a collaboration
00:05:40 [W] What are the missing functionalities and work together to design features in order to support data protection in kubernative sponsoring 6 for this working group are sick apps
00:05:56 [W] Next chain chain is going to talk about data protection definition.
00:06:03 [W] Thank you Hitchin in the following ten to fifteen minutes are walking through the definition of data protection in this working group.
00:06:15 [W] And what are the problems?
00:06:18 [W] We are looking to solve in this working group.
00:06:20 [W] What are the kubernative knative constructs?
00:06:26 [W] We are this working group is exploring or designing etc. Etc.
00:06:32 [W] Data protection in the industry can either refer to protecting data from compromise and I ensure data privacy.
00:06:35 [W] Or from time to time it also refers to ensuring that data and that application a prototype protected such that they could be quickly restored and recovered into any previously
00:06:50 [W] In data from compromise and I ensure data privacy or from time to time. It also refers to ensuring that data and that application a prototype protected such that they could be quickly restored
00:06:52 [W] There's a data loss or corruption happens.
00:06:55 [W] In this working group will focus on the ladder in the kubenetes environment.
00:07:00 [W] There are two major processes in data protection backup and Recovery the backup process produces durable backups of a system in many case backup processes are
00:07:16 [W] With certain all policies for example and add organization might want to enforce weekly backup of all its production database with business continuity reasons.
00:07:30 [W] And the recovery process takes a backup and restore resources in it.
00:07:38 [W] Particularly, it can be partially restauration or can be full restoration.
00:07:54 [W] It can be restored into a new system or it can be restored into the system from where from from which this backup is taken from and like backup process. The restore process
00:07:59 [W] Hulk manner from time to time for example only when there's data corruption or loss of data center in a disaster.
00:08:10 [W] In kubernative context the two types of entities in consideration when we talking about backup and Recovery API resources and the persistent volume data.
00:08:22 [W] There are many efforts to make kubernative Bo available and a resilient. For example, we introduced the redundancy mechanism for xcd and their products like flukes which is built on top of the
00:08:38 [W] Search the idea is to use git as a source of truth of desired declarative States.
00:08:49 [W] Most of the time they are those will be a llamo files Define your workload.
00:08:53 [W] However, there are still open questions to be answered.
00:08:57 [W] For example how to coordinate an application consistency snapshot back up in combination with our moment how to snap shot back up volume data tools like red or oh Kasten I designed to
00:09:12 [W] Problems a community-wide standard however is still yet to be developed and that's one of the ghosts of dead wood production working group.
00:09:24 [W] As a group we consider data protection kubenetes a very complicated and the layer problem kubernative knative building blocks are needed in the persistent bottom layer the application Level and the cost level.
00:09:40 [W] One of the major missions of this working group is to identify existing or missing building blocks to achieve backup recovery in different layers at Precision volume level.
00:09:57 [W] We need building blocks to support what I'm snapshot what in backup and restoration from Snapchat backup.
00:10:03 [W] Snapchat is already at beta feature supported by many CSI drivers in kubenetes since 1.17.
00:10:11 [W] Recreating a PVC from a warm snapshot has been released as part of the future.
00:10:17 [W] Compared to what him back up traditionally worm snapshot is the in general relatively cheap in a fast as it is as it is normally sits on the same storage media as the source warning.
00:10:32 [W] However, many Cloud providers implemented in differently in today's kubernative CSI drivers.
00:10:39 [W] I'll go a little bit deeper later.
00:10:40 [W] I'd application Level. We need to building blocks to for support group APR resources, which belongs to an application that basically defines all the API resources that
00:10:56 [W] These particular application. We also need choirs and inquirer's hooks, which can tell specific application to Temporary freeze yourself to achieve to achieve application consistency
00:11:11 [W] Cup, and I'm freezing self after work.
00:11:16 [W] this is particularly important for those applications which Cassius rights in Iran acquires hook allows them to flush rights to the position layer before a warm snapshot is taken, of course on top of that we do need
00:11:32 [W] That for workloads would do need what I'm snapshots and won't back up. Lastly cost level we need all of this about
00:11:43 [W] So we've talked about what we need. What do we have today?
00:11:49 [W] In the persistent volume level 1. Mm. Snapshot is already bad as mentioned.
00:12:02 [W] I will try to cover more details in the following slides the plan to move this feature to GA in the latter version in the application Level.
00:12:07 [W] They are rich fundamental workloads. Epi is such as that faucet replica said deployment Etc.
00:12:13 [W] Based on those fundamental workloads, PA eyes, sick apps introduced an application cri-o be which targets at providing a standard API for creating we're in and a manager plication zinc openfaas from higher level.
00:12:29 [W] Application cri-o D groups different components together into a single object such that they can be managed together. And this is something can tell in the back that protection context.
00:12:48 [W] What are the resources that constructs and construction application?
00:12:51 [W] As it many modern application workloads.
00:13:01 [W] On top of that you from time to time also need a service. If you take a look at the definition of the application grpc.
00:13:25 [W] Look at the in the middle the application can basically theoretically take any group kinds of existing kubernative constructs State force a diploma and services Etc.
00:13:40 [W] And the right-hand side is example, which is a typical mongodb.
00:13:42 [W] You can take a look at the componentconfig section.
00:13:51 [W] There's a service which exposes Mungo interfaces to external kinds and there's also application which is a kind of a stateful set.
00:13:55 [W] Which hosts the real workloads for this mongodb?
00:13:59 [W] Application crd gives a potential way of data protection working group can use to define an application and a group their API resources that belongs to the application for snapshot and backup.
00:14:15 [W] Moving on to what?
00:14:19 [W] I'm snapshot we have it has been a better feature. However, there are still gaps need to be filled to move it to ga.
00:14:30 [W] Is also application which is a kind of a stateful set which hosts the real workloads for this mongodb.
00:14:32 [W] Application crd gives a potential way of data protection working group can use to define an application and a group their API resources that we don't stir their application for snapshot and backup.
00:14:34 [W] Moving on to what? I'm snapshot we have it has been a better feature. However, there are still gaps need to be filled to move it to ga.
00:14:36 [W] One of the things the community is working on is to provide richer metric support and observability around the 1mm snapshot controllers.
00:14:40 [W] And the other thing is because the warm snapshot utilized a very similar way of PV PV, c-- that conducts bi-directional binding it is from time to time
00:14:56 [W] metrics support and observability around the 1mm snapshot controllers
00:14:57 [W] And the other thing is because the worm snapshot utilized a very similar way of PV PV.
00:14:58 [W] c-- that conducts bi-directional binding it is from time to time prom to arrow for users to mutate some of those fields and the cause the bonding lost.
00:15:04 [W] In the before we print the feature to GA with like to introduce web Hooks and validation such that what I'm snapshot and what I'm stocked accountancy on cannot be easily modified.
00:15:19 [W] Feature to GA.
00:15:20 [W] We'd like to introduce web Hooks and validation such that what I'm snapshot and what I'm stopped our content cri-o cannot be easily modified to violate some.
00:15:22 [W] by bi-directional bindings.
00:15:24 [W] And I will also look into extent old existing end-to-end tests in the kubernative environment.
00:15:36 [W] It's part of the kubernative CI jobs so that we have more confidence on this feature.
00:15:44 [W] One of the things I want to mention a little bit more is a stress testing because what I'm snapshot as a fundamental building block for application Level snapshot and application that will back up it is webassembly.
00:15:54 [W] Re critical to make sure the runtime of making a warm snapshot as short as possible because applications will need to free themselves so that they are not taking any
00:16:09 [W] Where we critical to make sure the runtime of making a warm snapshot as short as possible because applications will need to free themselves so that they are not taking
00:16:11 [W] Someday, yeah, we don't want that Kira to be long. So having stress testing around this feature allows the gives us more confidence on the controller level that we can do this thing efficiently.
00:16:26 [W] Upcoming that what we talked about what we have so there's a lot more what we are missing.
00:16:35 [W] We are still missing woman backup functionalities in the kubernetes environment.
00:16:44 [W] We still are missing back up repositories.
00:16:52 [W] This is more about storing backups into a different storage media. Then your primary storage such that in cases like a disaster recovery where you don't have your data center or your cluster around you still
00:17:00 [W] Back up seat somewhere maybe in the called or maybe in somewhere Place some others better Center that can restore your original data center into an X into a different place.
00:17:12 [W] We are missing choirs and unclear Hooks and applications snack application Level snapshot and pack up.
00:17:19 [W] Next she is going to walk you through all the working items in this working group.
00:17:26 [W] Thanks, Jay.
00:17:32 [W] So I'm going to talk about what we have been working on as showing this slide.
00:17:40 [W] We have been working on the design of many new features.
00:17:46 [W] The first one is the generic data populated this allows a PVC to be provisioned for external data source, not just the one snapshot or another existing TV.
00:17:58 [W] See by the could be an object store a GitHub repo or image or something else.
00:18:02 [W] this is very important in the back up and resolve have it allows us to dynamically provision a PVC based on a story class create an underlying volume and allow data on that a volume to be restored from someplace else such as
00:18:17 [W] Depository create a PV to point to that volume and then that kubenetes TV controller to binder that TV and TV see this makes it possible to honor the wait for first consumer volume by me mode during the restore
00:18:33 [W] This makes it possible to honor the wait for first consumer bonding bonding mode during the restore to ensure Warden is placed at the right node, while the Pod is created.
00:18:42 [W] There's already an any volunteer. This was feature gate, which was introduced as an alpha feature in 1.18 release.
00:18:51 [W] We want to have a generic data popular implementation so that we can promote this feature to Beta in the 20.
00:18:58 [W] The next one is Quest inquires hooks.
00:19:06 [W] This is to figure out how to quite as an application before taking a snapshot and Uncle as afterwards to achieve application consistency.
00:19:17 [W] We initially proposed to to introduce a excluding hooks your D for dynamically, executing users commands in a pod container and exclusion controller
00:19:26 [W] Hooks like psycho ex clean hook provides a generic mechanism for users to trigger who commands in their containers this proposes to new CRTs
00:19:42 [W] A hook action ci/cd that describes Action commands to run on Port containers and an execution hooks your lie, which describes where in which part container to run a specific?
00:19:58 [W] Action, however, because this requires an external controller to run a command through poddisruptionbudgets source to do the quest. It erases the security concerns from the a peer reviewers.
00:20:14 [W] So now we are actually looking at a different approach also in addition to quite as on Curious application.
00:20:23 [W] There are other use cases that require the user to send a signal to the Pod to trigger certain.
00:20:28 [W] Ten comments for example send a signal to a container to flush logs changelog Rusty reload configurations Etc.
00:20:42 [W] So our new proposal is to add in inline prodyna Nation to send the containerd signals or run comments inside of the container and a new API object to send a request
00:20:54 [W] Signal or comments.
00:21:01 [W] Thanks in a controller such as the application snapshot controller will signal when the CP object should be created and when kubeedge should be running this command inside the container.
00:21:11 [W] So kubelet will be the one that is watching the objects and the run the command when it is created and updated their status or cordially. This feature is still under design discussions.
00:21:26 [W] The next one is the voting group and good snapshot.
00:21:31 [W] This proposes to introduce a new Warden group ci/cd that groups multiple volumes together and a new group snapshot cri-o that supports taking a snapshot of all volumes in that group.
00:21:47 [W] The next one is the volume group and good snapshot.
00:21:48 [W] This proposes to introduce a new boarding Group C are D that groups multiple warrants together and a new group snapshots grpc that supports taking a snapshot of all volumes in that group.
00:21:49 [W] Sure, right order consistency.
00:21:55 [W] We are also looking at how to use the voting group concept to support failure domain spreading. For example how to place volumes in the same group across different discs on the same story system.
00:22:04 [W] And the next one is the object bucket provisioning this proposes a object storage cuentas API to support excretion of objects to operations for
00:22:20 [W] Therefore bringing object storage as the first class citizen in kubernative just like file and block storage.
00:22:32 [W] It also introduces the container object storage interface or cozy as a set of grpc interfaces for provisioning object stores, its supports the major objects
00:22:45 [W] Tessa three Google Cloud Storage has you blob well-being extensible so that we could add other particles in the future.
00:22:59 [W] It proposes to support both Greenfield for new bucket provisioning and brown food for existing market operations.
00:23:09 [W] It proposes a several new cri-o is a bucket requests early, which is uses namespaced.
00:23:16 [W] Which represents a request for bucket and a bucket class is a cluster scope to see our D.
00:23:26 [W] It defines the provisioner and also has a set of parameters for creating new buckets and buckets the already that is also cluster scoped.
00:23:40 [W] It's it refers to a physical bucket in a cloud when the print and contains connection information and metadata to
00:23:47 [W] Decatur with a physical bucket
00:23:48 [W] for this feature. They have been weekly design meetings.
00:23:55 [W] It has become a sub-project under 6 storageos.
00:24:05 [W] More features that have been working on the first one is volume back up.
00:24:27 [W] So the motivation for this feature is that the existing volume snapshot feature was not explicitly designed for backups because there's no explicit definition in that design to have snapshot stored.
00:24:37 [W] Different backup device separate from the primary storage for most Cloud providers a snapshot is actually a backup that is uploaded to an object stored in Cloud.
00:24:53 [W] However, for most others through the vendors a snapshot is locally stored alongside of the volume on the primary storage.
00:25:02 [W] Therefore, it is impossible to design a portable data protection policy that work for all the soda vendors.
00:25:06 [W] So the goal of this effort is to come up with a design for voting backups that are different from what the snapshots but. Otherwise the user if you guys should be somehow similar
00:25:23 [W] We still need apis to take a backup of the volume to provision a volume and populate about from a backup.
00:25:34 [W] This warning backup feature is still in very early design stage.
00:25:43 [W] The next one is application snapshot backup and restore Center is a cap for this it proposes a kubernative staefel application data management API that collectively Define
00:25:51 [W] For applications this refers to applications that maintain a persistent State and defines Holly. Robley how to run operations on those applications to do snapshot
00:26:07 [W] A snapshot of first a publication is defined as a point in time capture of the state of the application ensuring application consistency.
00:26:22 [W] It captures both the application configurations, including kubernative resources such as osteoporosis Services computer Maps secrets, and so on and persistent data contained within
00:26:33 [W] these resources such as SQL Server R Services computer Maps secrets and so on and persistent data contained within the application through the prison wardens and
00:26:38 [W] In through the position the volumes and this feature is also still designing progress.
00:26:41 [W] And the next wise data production workflows.
00:26:51 [W] This one group has also started working on a white paper to Define data protection workflows.
00:26:55 [W] So we are also working on other things. They will be some potential topics that we may discuss in a future as shown here.
00:27:12 [W] The first one is the divs between two snapshots.
00:27:18 [W] This can be changed blocks four blocks volumes or change. The files forth are volumes.
00:27:22 [W] This is just for incremental snapshots or backups.
00:27:24 [W] We actually have not started discussion on this topic yet.
00:27:28 [W] and second one is to here is data production policy this usually refers to how we can set up scheduled to do periodic backups and set up a backup retention policy
00:27:42 [W] Clean up old backups or set up a fake apology to specify the cup location. This can also be used to specify an encryption policy for backups.
00:27:55 [W] This topic also has not been discussed yet.
00:28:02 [W] So I've talked about what are we have been working on and what other potential topics next? I will talk about how to get involved.
00:28:09 [W] So if you are interested in getting involved in this working group take a look of the wing groups communicate Community page first.
00:28:26 [W] It has a lot of information to get you started join the biweekly meeting on Wednesdays at 9:00 a.m.
00:28:31 [W] Pacific Time previous meetings are recorded and available on YouTube during the mailing list and the slack Channel.
00:28:39 [W] This is the end of the presentation.
00:28:44 [W] Thank you all for attending the session. If you have any questions, please don't hesitate to reach out to us.
00:28:50 [W] So I think now let's look at the questions.
00:29:04 [W] the first question is
00:29:11 [W] the first question is
00:29:16 [W] is the API is a is the application cri-o already available check in D1. Take that.
00:29:27 [W] Paper.
00:29:31 [W] Yep.
00:29:32 [W] I can't hear you.
00:29:36 [W] Yes. The API crd is right now you can we want better one.
00:29:38 [W] So yeah, it is available.
00:29:39 [W] Send questions. Does this working group collaborated with like sneer or specific vendors to benefit of their years of experience?
00:29:56 [W] Yeah. So in this working group, I think there is one page that we shown earlier in the presentation.
00:30:02 [W] There are multiple vendors supporting us. For example, see
00:30:08 [W] So that 20 see the page like some of their traditional sorta vendors like Italian SI not up.
00:30:21 [W] There is a bien.
00:30:27 [W] Yeah, so there are actually multiple our vendors already supporting us and then they they are in this working group.
00:30:34 [W] We are not a collaborating with the snare specifically, but I think many of the vendors doing this one group actually work with sneer so we can definitely use more of their
00:30:39 [W] there
00:30:40 [W] was on top of the
00:30:46 [W] we discussed a little bit about storage vendors, but data protection the concept in Google Nexus is slightly bigger than that. We do all cooperator and work with problems
00:31:02 [W] That we do all cooperator and work with problems like way Laura right?
00:31:06 [W] We're like cast them from the application perspective and the cost of perspectives as well supported. That's it.
00:31:20 [W] it. I'm a next question. How would you judge the need for kubernative yielding back up with sort of abilities versus the
00:31:25 [W] in itself just handling it at a higher level. That was question.
00:31:33 [W] That is always been a discussion point for traditional locations.
00:31:40 [W] Yeah. So we think that we should still have this capability building to communities as you can see that we actually got a lot of support from Wacom vendors and
00:31:49 [W] To have this capability in kubernative.
00:31:54 [W] There are many missing pieces.
00:32:02 [W] So if we can provide those missing pieces, then that would enable the storageos the back of vendors to have a full solution for the other production
00:32:09 [W] So for having application handle itself at our high level.
00:32:15 [W] level. I think they could still do that. But we can also we can also integrate those capabilities as part of kubernative capabilities such as you want to add anything there.
00:32:29 [W] Sure, this should be clear at this question was about us.
00:32:34 [W] Goodbye. I drank so we don't think those two concept conflict with each other by rather they work with each other.
00:32:49 [W] So when we look into solving the problems in the data protection problems in kubernative count cons context
00:32:54 [W] One of the things is that how can we as a community Supply essential building blocks to solve applications problem, right? For example one snapshot?
00:33:10 [W] Solving the problems in the data production problems in kubernative count cons context one of the things is that how can we as a community Supply
00:33:11 [W] Wouldn't group him application-level Resource Group in etc. Etc.
00:33:18 [W] Those are all fundamental building blocks such that application data themselves can effectively achieve application consistency stabbed shot or back up from that perspective.
00:33:30 [W] We are not trying to step into the business of taking care of application consistency snapshot right by rather provide try to provide him on the mental building blocks such.
00:33:42 [W] In this sense, I think the end of the day applications are the ones application owners are the ones who knows to do the backup and the snapshot and us as a community in the place
00:34:43 [W] Without this they will be just directly using the exact sub resource to do this acquires.
00:34:54 [W] But with this tool it will be much easier with our eyes are so actually part of this working group.
00:35:03 [W] So yeah, so we are not really like swapping the whole problem that we are basically trying to provide in some missing tools that they can use
00:35:11 [W] Let's question since there is no change block tracking snactives feature. Does this mean that everyone in back up there be a full backup and not incremental backup anytime.
00:35:28 [W] I'm for when you might Implement a difference for yes.
00:35:32 [W] So this is actually I'm sorry.
00:35:36 [W] You want to read the the last piece of the question slightly louder? I couldn't hear you. Oh.
00:35:39 [W] Any timeline for where you might see incremental give support?
00:35:43 [W] Yeah, so basically this is something the change block tracking the something actually brought up by the back on vendor as one missing piece in quantities, we haven't got a chance to tackle this one so
00:35:59 [W] And yes, so this is actually it's all right, you want to read the the last piece of the question slightly louder? I couldn't hear you. Oh.
00:36:01 [W] Any timeline for where you might see incremental give support?
00:36:01 [W] Yeah, so basically this is something the change block tracking the something actually brought up by the recommender as one missing piece equality' we haven't got a chance to tackle this one so I think
00:36:02 [W] Well that the vendors will just have to do this themselves because of but we don't really have experienced explicit API to do this, but I think this is something that we should be talking about
00:36:15 [W] In the future. We haven't really get to this one yet.
00:36:20 [W] So right now if you if you are doing a if you want to do a backup, then is really depending on the specific backup application race leader can go automatically check if it's the if the first
00:36:36 [W] One could be automatically a incremental backup.
00:36:42 [W] Yeah, so we don't serrena. We don't really have a timeline yet, but this is definitely in our Charter.
00:36:51 [W] Okay, little guy said we're running out of time.
00:36:59 [W] We compare the tools.
00:37:01 [W] We look this Valera. What's the main difference?
00:37:05 [W] Oh, as I said before we are basically just providing some missing pieces in community. So volara can actually leverage it.
00:37:11 [W] Any thoughts on the ability to classification tikv backup if take a snapshot the etcd is not always feasible to to access issues.
00:37:24 [W] Yeah, so it is indeed. We are not tackling the etcd itself at this point, but I think that that could be when we look at our like back up the whole cluster then we can look at that piece, but that's
00:37:38 [W] Some other tools, we are really trying to figure out how to do choirs people taking snapshots.
00:37:49 [W] I think that's all the questions I have here and also really we are running out of time.
00:37:51 [W] Thanks, everyone.
00:37:52 [W] All right, if you are more questions, we are in the stack panel.
