Kubeadm Deep Dive: DBLJ-8610 - events@cncf.io - Wednesday, August 19, 2020 6:50 AM - 62 minutes

Participant: wordly [W] English (US)

Transcription for wordly [W]

00:03:58 [W] Welcome everyone. Thank you.
00:04:00 [W] Welcome everyone.
00:09:58 [W] Thank you for joining the QB M deep. Dive. Today. We are going to do an introduction of what QA diem is.
00:10:04 [W] We will also look at where is the current active QED?
00:10:07 [W] Mm? And what is the future for it?
00:10:08 [W] for that his Rush with me, so we're going to make an introduction disrespectful head.
00:10:14 [W] Incredibly and roast suffered. Simply Ross bof. I work at VMware is open source Technology Center as an open-source engineer. Hello.
00:10:27 [W] I'm Rafael. I Workforce you say Anunnaki BTM contributor.
00:10:31 [W] So let's get into the contents of the presentation. So what is Cuvee diem QED music when it is not bootstrapper.
00:10:46 [W] It's basically a tool to get a new enviable secure cluster running in a user-friendly way.
00:10:51 [W] It's it's important to note that we have some requirements before you can bootstrap your cluster.
00:10:59 [W] cluster. So in this case someone or something has to provide you on scene or a set of machines where you are going to run qad m.
00:11:02 [W] Containerd runtime on the kubelet must be already installed.
00:11:09 [W] They want the runtime can be cryo can be containerd e can be darker any of those will work Kuma TM will not install any cni-genie you and you see and I plug in so you have to choose with cni-genie you want to to use and install that
00:11:20 [W] You made the ant has both straps or plaster on our end to end tests.
00:11:26 [W] We are using Calico, but you can use any cni-genie.
00:11:50 [W] It's thought in order to provide centerfold for the majority of these cases you might have but also if that doesn't fit the bill then the idea is to make the other part possible.
00:12:05 [W] So this is part of the activity and is part of the C cluster lifecycle project or the Sig.
00:12:15 [W] So the objective of this sig is to simplify creation configuration upgrade downgrade and tear down of kubenetes clusters under componentconfig.
00:12:20 [W] And so can we the m is like the glue between the user and the number of components that kubenetes has in this case we can see here the diagram.
00:12:34 [W] We have a number of components a number of projects.
00:12:41 [W] For example, it's the ADM allows you to create a number and a number of its EV instances a number of its the Clusters along the lines of how cubed e analogy to create a kubernative cluster. Then we have also the cluster organs project on the Sig also
00:12:49 [W] In 200 is cluster. Then we have also the cluster out on this project on the Sig also cluster Epi that we will see that in a second.
00:12:57 [W] You see Steve ADM or can use to ADM. We have other projects, like for example, the componentconfig goes across different 6 and across different projects and also communities cluster provisioners that can use class 3 Pi in order to Define
00:13:07 [W] Different seats in the crew different projects and also kubenetes cluster provisioners that can use cluster API in order to Define and create decorative clusters in Cardiff way.
00:13:14 [W] So who uses qbd em until now aren T very until very recently or relatively recently.
00:13:21 [W] It was we have a very good base of users human people who actually goes and runs to medium or uses some tool interactivity em, but from from some time,
00:13:32 [W] Many projects have studied used to be diem as well and to actually use that and say their project. So for example, we have minikube we have kind or we have class 3 pi/4 some of the CPI has a concept of bootstrap provider and
00:13:45 [W] There for example for kiwi DM allows you to use cluster.
00:13:49 [W] Epi that will use Q ADM bootstrapper to actually in July's your clusters.
00:13:56 [W] So how does give a lien work?
00:14:00 [W] We have different ways of setting your cluster only the single control plane scheme and that is the hso4 the single control plane.
00:14:11 [W] your worker nodes will Point directly to the control plane note. So these are very simple schema probably for some kind of see I or
00:14:17 [W] Something that you want to test for example in a really fast way and then we have the ait's a setup.
00:14:30 [W] So for the a tea set up we have the worker nodes that will talk to you to to the load balancer will reach the ready to the load balancer that will in turn.
00:14:37 [W] balance is older API servers on your control planes. So convenient will take care of managing the control planes or of configuring the Consultants are grading them. But comedians will never manage your load balancer. So we have
00:14:47 [W] When this on how to set up the load balancer, but you medium is not going to match the load balance for you.
00:14:54 [W] So you have to manage that in the best way that you are doing right now.
00:14:59 [W] So what is the main workflow of Q ADM? So the main workflow is to set up a new cluster.
00:15:11 [W] Another component running on top of the cluster and we want to deploy poddisruptionbudgets.
00:15:45 [W] The condition is pretty extensive.
00:15:49 [W] So you only have to look a have a look at that.
00:15:51 [W] But in this case you just say where the control plane hostess with the control plane Port.
00:16:05 [W] Where is the token to join in talking the bootstrap token the discovery token say star that has so you know that you are reaching the the API server that you expect. There is no money in the medial happening you say that this is a control plane and then you pass on the certificate
00:16:11 [W] Or the creeping some secrets that were upgraded on the comedian need some certificates that without the integrated and upload it to the cluster after it was initialized.
00:16:25 [W] And and so if you join more control things you want and it's a setup.
00:16:26 [W] Do you want this secrets to be decrypted and the certificate key is how it's decrypted. So after you have joined these this optional secondary control planes, you can go ahead and drain worker nodes. This worker nodes will actually run your workloads.
00:16:40 [W] It's very similar to the previous step but it's in North simple because you only have to run comedian join pointed to the control plane host control plane Port if you have an ETA set up, this will be typically your load balancer.
00:16:56 [W] There is in front of older API servers, but this can be it depends on your setup.
00:17:03 [W] So you again use the token the bootstrap token.
00:17:06 [W] So the kubelet in this worker node will be able to join the k3s cluster and the register itself and then again the discreet
00:17:11 [W] Token ci/cd has so it again knows where it's written to accommodate that but here EDM is not only for bootstrapping here EDM can also upgrade your cluster.
00:17:25 [W] So where is the agricultural of key BDM? You can check what upgrades are there available for your for your clusters?
00:17:36 [W] So qbd I'm will check with which running version of cubic units you have.
00:17:37 [W] This is stored in a configuration that will seem second but basically
00:17:41 [W] You can just ask you BDM.
00:17:49 [W] I have this version of kubernative, please that puts version of communities I have and please check if there are new verses are available released.
00:17:56 [W] So give me the map grid pattern will tell you not only to learn is versions, but also other atoms for example, Korean s or other other atoms and then you can actually upgrade your custody if you if you want to so you
00:18:05 [W] So you only have to rank medium upgrade apply on your first control plane note.
00:18:12 [W] It doesn't need to be the control plane where you bootstrapped.
00:18:17 [W] The first note is just one of the first king of the control planes that you want, but you run qbd mlperf apply only once on this very first contract in the you want and then you go on with the rest of the country being the secondary control
00:18:27 [W] If you don't have an ETA, you said you only gold early with the workers and then you rank your video in my grid node on all of them secondary control planes and worker nodes and this will basically read the configuration and see what needs to move to
00:18:44 [W] Let's see what he's deployed when we deploy a control plane with Cuba DM so you can see the blue boxes which are communities components the part were we are talking about the control
00:18:59 [W] It's basically Cube contract manager.
00:19:04 [W] tuba scheduler qapi 7q proxy. You can mix and match and remove some of these components but this is the default setup.
00:19:11 [W] So we are going to focus on this one.
00:19:17 [W] So it always will also deploy called DNS as a as an add-on.
00:19:27 [W] Also, we have it CD with something that we also deploy as a starting manifest the same as about the rest of the control plane, but they are its TV is on the run on the console play notes. You need to have you need for
00:19:31 [W] or contrivance to talk to each other in order for it to be to be able to work properly and then you have the cni-genie about the do deployed on top of it.
00:19:44 [W] This will typically run across all your old your notes to contribute and worker nodes. And then on your worker nodes, you only have this cni-genie pot.
00:19:49 [W] pot. We said before kubeflow oxy from from QED em, and then you're aware workloads. So that is basically it and that is what is deployed and we try to make it minimal so it's really easy for
00:19:59 [W] So we were talking before about the config.
00:20:03 [W] So we when we upgrade we read the configuration that we are running actually right now of kubenetes so we know there's a new version available.
00:20:10 [W] Where is this? What is this placed? So this is a configuration map living on the namespace keep system.
00:20:17 [W] It's called QED and config and this contains the cluster configuration on the cluster status object that basically qad and uses an upgrades or torches or updates in order to know. What is the current state of your
00:20:29 [W] And also compare that to a future state for example, if you're trying to upgrade or if you're trying to do something else so qbm will basically download this config map when you do some operations like joint for example or upgrade. This
00:20:44 [W] When you do some operations like joint for example or upgrade, this is security and conflict conflict. My will be downloaded will be compared and will be probably updated depending on what you did. Ask qad.
00:20:52 [W] em. So what is the current state of the project?
00:20:56 [W] So right now QED n is stable and UGA it supports HTML element.
00:21:04 [W] are also testing this on. Our CI. Our configuration is right now at the 1 beta 2 version weaveworks.
00:21:09 [W] Are in discussions to introduce a D1 beta 3. We are really conservative on the changes that we made to the population.
00:21:18 [W] It has two elastic support.
00:21:25 [W] You can also customize your aesthetic pots. So comedian Will Wright the static ports at kill it brings them up.
00:21:28 [W] So for this these components that we were talking before it CD anchoring this components control plane components.
00:21:37 [W] You could use customized before in order to customize the static ports, but this changed Rose.
00:21:38 [W] We'll talk about that in a second comedian.
00:21:43 [W] So a certificate management so you can create certificate secondary users. If you can see if you provide them. It will also renew them. If it can if it is if it has the CIA and the key for the ca Sookie we didn't win General.
00:21:54 [W] take care of all these for you comedian has to manage it ci/cd mode the default one we call these the Stacked it CD.
00:22:04 [W] you can also use external it's in if you want by by providing this into the configuration, but by default gradient will just make months this for you. So
00:22:09 [W] Holiness and kubeflow FC so you can opt of opt out of them. But by default they are they are provided and then we have faces reports on the workflow that we were seeing sewing seen before all these faces will be running one after the other
00:22:30 [W] But you can instead of running the whole workflow.
00:22:36 [W] Yes run the parts that you you care about the part that you want to run.
00:22:41 [W] So this is the faces support and right now to medium in it join preset and upgrade node supports phases. We more commands will introduce this in the future. And with that I will leave that to us. So yeah. Thank you for listening in the
00:22:52 [W] In release we're introducing touches. This is a replacement for the old system. I support that we introduced or 10 years ago, but we have already deprecated.
00:23:08 [W] So these patches are good all well-known kubectl patches and easily strategic Jason and mulch patches.
00:23:19 [W] They're much more lighter and simpler to use than the old customized patches and but they're basically used in the
00:23:22 [W] same way as twice patches too much static ports on a personal basis as we are actually trying to deploy a control plane owed.
00:23:35 [W] These patches are specified the cube a team using a specific directory for four different patches.
00:23:45 [W] Every patch is placed in its own file and the files are named in those specific convention, which can see on screen, but I'm not going to covered in great detail.
00:23:53 [W] It is for example, you can see a couple of pushes here in action. The first Arch on the top left is a strategic option among format.
00:24:07 [W] that's going to be applied against the people troll manager popped and it's going to introduce a new mutation or destination.
00:24:17 [W] Start of the control manager the second touch here. The one on the right is being applied against dhcd static pop and it's using the merge strategy and enjoy some Json format.
00:24:33 [W] These patches are all specified by placing them in a single directory and after directory is supplied as an argument to the - - experimental purchase command line option. And this option is Right Now
00:24:50 [W] Supported by cupid in it giving them join zebrium Greater by incubating upgrade note amounts.
00:24:56 [W] Another thing that we are actually preparing for your own in 119 is some componentconfig updates. Now most of the componentconfig updates are actually happening under the hood, but in 119, you can see
00:25:12 [W] We have actually introduced a new componentconfig state table that's going to be printed out at the end of the Cuban great fun command.
00:25:25 [W] The state table actually shows you the different componentconfig API groups the current version and the preferred versions of these can fix it also shows you whether actually a manual upgrade is acquired any of these conflicts.
00:25:38 [W] Now what is ahead for cubed in the first and probably the biggest change that lays ahead forgiving is moving to bidam's source code from the main communities repository, which is our github.com.
00:25:54 [W] Matey's knative into the Cuban and specific heat capacity which is going to be with your account such communities of kubeedge a now this is effort is actually put my house right now, simply because
00:26:09 [W] There's a lot of different changes to see I and release infrastructure. It also requires a little bit thinking on how versioning is going to apply it and stuff like that.
00:26:24 [W] So we're currently Posey conduct. But this is one of the future items that we are actively looking into.
00:26:33 [W] Another thing that is going to be implemented.
00:26:40 [W] Some point is machine readable output current curriculum supports machine-readable couple of its commands here is one of them the kuma damn openly system and it can actually open
00:26:51 [W] in llamo Jason and human readable formats as shown here.
00:27:06 [W] Unfortunately, the machine-readable passport is a little bit under stuff at the moment and we're looking forward to have perhaps new contributors to keep a team who can actually resume that effort and
00:27:10 [W] machine readable output for practically all kubectl commands
00:27:15 [W] In addition to that we already mentioned several times componentconfig. But what is actually a component of it?
00:27:28 [W] It's a structured API object that is designed to replace the command line options that are used to specify different settings to you pay to abilities standard components now these
00:27:39 [W] some online options usually take something like
00:27:45 [W] Hundreds of different types, so it's like it's good to just put them in a single well-structured object and have that supplied instead of can quite long
00:28:00 [W] Go online.
00:28:02 [W] Come on lines different components.
00:28:09 [W] So this is why we're trying to actually implement the componentconfig support for components that actually Supply such support to them.
00:28:20 [W] them. So we're looking forward into improving. The uxk are grammatically and capped is implemented.
00:28:23 [W] We regards to keep am standard configuration.
00:28:29 [W] Currently.
00:28:33 [W] we have support for view on that one and we want better to but it won't be the one is deprecated. And it's going to be at some point in the near future removed entirely at the top point in the near future.
00:28:44 [W] We are also going to increment V1 better 3, which is currently in the process of being discussed. And once that happens we are going to also deprecated you one better to and scheduled for removal.
00:28:57 [W] Tristan year after
00:28:58 [W] also other things that lay ahead for us are the Cuban mm operator, which is basically a standard kubernative operator that is designed to handle day-to-day operations.
00:29:13 [W] But when it is Coastal to deploy our Cuban and this efforts again a little bit understaffed people started by for be to continue, but apparently he doesn't have much time to work with it.
00:29:26 [W] So we are looking forward into possibly having some ideas and
00:29:30 [W] Sure thing is the first integration with the coastal Adams project integrating with closer atoms is really nice because to allow Cuban to stop maintaining some of the
00:29:46 [W] Adams and that's will make our code base much more narrow and our place buddy.
00:29:54 [W] Also trimming the issue back lock is on our agenda.
00:30:06 [W] Currently. We have a little bit more than 20 issues in our tracker, but this is not too much.
00:30:11 [W] It's not too little but it needs tackling to speaking of the issue tracker our issue tracker has already been moved to the new Cube am repository. You can find it using the QR code on the right.
00:30:21 [W] It's basically if bol.com such communities frustrated.
00:30:24 [W] if you decide to try to contribute to keep paging there is a really good kubenetes mon boarding video that was recorded by Boomer last November a link to that video is
00:30:40 [W] Token on the right here, and you can watch it on YouTube.
00:30:46 [W] In order to reach us you can you have several options.
00:30:55 [W] The first option is reaching to us some slack.
00:31:00 [W] We are active in the sequester lifecycle channels in the creative child suppose. The lifecycle channel is a little bit Tha more development-oriented Channel and kubeedge L is a little bit more user oriented
00:31:10 [W] Both of these channels around kubernative stuck.
00:31:17 [W] Our thing is that we have weekly meetings each Wednesday at 9:00 9:00 a.m.
00:31:23 [W] .
00:31:37 [W] Us Pacific Time a link to the Google Doc containing the agenda and the zoom link can be found on the bottom. But in order to access that document first have to join our Google group.
00:31:39 [W] That is the Google group for Community sequester life.
00:31:40 [W] On a QR code on the right contains the link to the Google group and how to join it.
00:31:49 [W] Thanks to these folks here.
00:31:55 [W] Cuban has been brought to you for the past year and a half two years.
00:31:59 [W] Of course, there are many other contributors ones that came before those and was that it sounds simple, but just over the past two years but
00:32:12 [W] Major contributors and the folks that who actually look after and take care of you ready?
00:32:22 [W] So thanks to them you can use given in right now.
00:32:25 [W] And of course a reminder sequester are cycle is doing a survey.
00:32:38 [W] This survey is a really nice one and it covers of high level six questions as well as different questions regarding different
00:32:46 [W] It's the third under the Hat of sequester parsec.
00:32:50 [W] o towards that survey. Please use the QR code. I showed here and remember that when you actually feeling that survey you actually great help different
00:33:05 [W] It's in the city as a whole.
00:33:07 [W] With that.
00:33:10 [W] Thank you for your time questions. Thank you.
00:33:13 [W] So thank you very much folks.
00:33:26 [W] So I can probably try to answer wife here a couple of questions.
00:34:37 [W] The first one is y cubed m is not shown or user recommend in the different guides are required to prepare for the c k /c Ki D exam.
00:34:39 [W] Is it not ready for production yet.
00:34:41 [W] You bet. I am is actually ready for production.
00:34:43 [W] It's GA and it's it's been quite stable and it's
00:34:49 [W] Foundation for many different projects such as coaster API and you so minikube also use it kind uses it and many third parties as well.
00:35:03 [W] So it's been around for quite a while and it's GA. So it's ready for production why it's not included in the exams.
00:35:14 [W] I'm not quite sure and yeah, probably
00:35:17 [W] we can ask the Elders of the exams.
00:35:22 [W] And the other one is why it's it is not exposing Matrix and point for grooming for Prometheus for default.
00:35:48 [W] Now this as far as I remember, it was supposed to be like security picks because it was exposing Matrix.
00:35:55 [W] on my like HTTP and
00:36:00 [W] And the other one is why it's it is not exposing Matrix and point for grooming for Prometheus for default.
00:36:08 [W] Now this as far as I remember, it was supposed to be like security fix because it was exposing Matrix on like http.
00:36:08 [W] Tucker and it was disabled.
00:36:11 [W] I've got more questions.
00:36:51 [W] so
00:37:29 [W] yeah.
00:37:32 [W] so
00:37:39 [W] yeah.
00:37:39 [W] So my questions are coming through slack and yeah, we can continue answering those after the session here is over on slack. And yeah.
00:38:28 [W] So the about the security question.
00:38:33 [W] Probably the latest versions are of this example based on cubed M.
00:38:44 [W] But I haven't seen that examined.
00:38:49 [W] I haven't taken it and I don't know.
00:38:50 [W] What's what's exactly in there.
00:38:51 [W] So.
00:38:52 [W] I cannot say for certain.
00:38:57 [W] Session here is over on slack. And yeah.
00:39:09 [W] So the about the c key question.
00:39:09 [W] Probably the latest versions are of this example based on cubed M.
00:39:10 [W] But I haven't seen that examined.
00:39:10 [W] I haven't taken it and I don't know.
00:39:11 [W] What's what's exactly in there.
00:39:11 [W] So.
00:39:11 [W] I cannot say for certain.
00:39:11 [W] Our question is coming from slack will give a name get support or other surface proxies than the default.
00:40:12 [W] Currently. We are not planning for such and support but what we are looking for working to this to allow users to just skip installing Q proxy so they can basically
00:40:20 [W] Our question is coming from slack.
00:40:21 [W] We'll keep it in get support or other surface proxies than the default.
00:40:22 [W] Currently. We are not planning for such and support but what we are looking forward into this to allow users to just skip installing Q proxy so they can basically
00:40:22 [W] day like in its place
00:40:25 [W] Okay with that, I think that most of the questions here on the platform were answered. We can continue on slack. I can encourage you to join our
00:41:24 [W] The answer and ask your questions there. We can continue answering those immediately after the end of
00:41:35 [W] this session.
00:41:37 [W] Thank you very much.
00:41:38 [W] for your time
