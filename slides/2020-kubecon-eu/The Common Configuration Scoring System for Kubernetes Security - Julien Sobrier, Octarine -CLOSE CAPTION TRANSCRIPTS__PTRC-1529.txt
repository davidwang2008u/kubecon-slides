The Common Configuration Scoring System for Kubernetes Security: PTRC-1529 - events@cncf.io - Thursday, August 20, 2020 11:18 AM - 195 minutes

Participant: wordly [W] English (US)

Transcription for wordly [W]

00:01:19 [W] Bring system brief introduction about myself.
00:01:31 [W] I'm now part of VMware product manager over there and most important if you want to contact me.
00:01:36 [W] Yes.
00:01:45 [W] Okay.
00:01:57 [W] I'm just going to say something wrong on my side or if not, that's fine.
00:01:58 [W] Okay.
00:02:03 [W] Thank you for joining this call about the kubenetes common configurations Growing System.
00:02:28 [W] I'll start with a brief introduction about myself.
00:02:30 [W] My name is Tran.
00:02:31 [W] So Breyer. I'm now part of VMware more important. If you want to contact me in a few more question about the Casey CSS this talk or anything about who in his can contact me at Jaso Bio-Rad vmware.com.
00:02:43 [W] The short definition of kubenetes is that it's an orchestrator for containers, but we all know it's much more than that.
00:03:02 [W] It's defined the entire infrastructure for your Cloud finds. I provision Network load balancer storage how you get access to the containers one can of
00:03:11 [W] Privileges you gave to your container or back secret management Etc. All of them are managed by kubernative and every time you making a change or every time you're not making a change by using the kubernative default you're changing the security posture
00:03:26 [W] In the security posture of your application you make it more or less secure.
00:03:30 [W] There are over 30 is security settings that directly impact the the risk associated with your workload.
00:03:45 [W] There are things like are you breaking isolation between containers by sharing the same Pi PC or showing the hosts file system?
00:03:52 [W] Do you enable some of the capabilities that give you potential Network mine in the middle or enable Network sniffing? How do you expose workloads? You expose it to a load balancer or maybe by accident use the sheriff's?
00:04:01 [W] Could you allow people to do a cube City Airport forward directly to to a container?
00:04:10 [W] You have an interest policy an aggressive policy that might avoid lateral movement in your cluster writable file system privilege containers.
00:04:20 [W] kind of label of access do you have to the API and can a pod create other products a Secrets the different capabilities that might lead to easier containerless k8s.
00:04:31 [W] for example
00:04:32 [W] Do you have a way to make sure that container is not changing seccomp policy and boxing and then if you add more layers like servicemeshcon also another set of security features like encryption identity that you can enable.
00:04:48 [W] So the question is how do you know which a combination of settings is more or less? Secure.
00:04:58 [W] How do you know that these set of settings enable together for the same workload for example is actually worse than the other set of of settings where maybe some of the attribute of the workloads
00:05:13 [W] Like Network stiffing ability ability Shadows network.
00:05:23 [W] No might be remedied. It mitigated by the fact that you have encryption coming from your servicemeshcon.
00:05:24 [W] And what we saw is when we asked devops know what is the most risky workloads?
00:05:38 [W] You know, where is what's easiest way for an attacker to get into your cluster early most of the time say, you know, we don't know we don't have a good way to look at all of them settings overall and and give an answer of what are my most risky workloads?
00:05:47 [W] So we decided that we needed a way to give a clear picture that we can update in real-time all the risk associated with this which workloads so we look for a framework that will give us
00:06:05 [W] So one is give a score from 0 to 10. For example for each workloads. We can clearly see with the standards.
00:06:13 [W] What's not and other than and look at your most risky workloads first.
00:06:20 [W] We also wanted to make it clear how the risk is calculated know where there is come from and what can what are you actually risking the why are you risking?
00:06:32 [W] Maybe that exfiltration. Are you risking bringing down your applications? So we wanted all the details to to be part of the framework.
00:06:36 [W] And finally once you know what's know potentially dangerous you want to fix it or to remediate so we want the framework to be able to tell you what are the steps that you can take to reduce your risk?
00:06:50 [W] So we didn't want to reinvent the wheel. So we look at the other security framework that are being used there and this couple of them like the cdss the common gravity scoring system. If you are scanning Docker images,
00:07:07 [W] Variabilities being funny or images and being score with CSS framework, which the great way to describe the risk associated with each reliability and also describe it in terms of impact blast radius or
00:07:23 [W] Remotes or local access is required cetera. So CBS s is a great way to describe and score individual liabilities.
00:07:35 [W] And there was actually an attempt to apply the CBS s to configuration called the common conversation scoring system, which is derived from CSS.
00:07:51 [W] Unfortunately, this project is for the all in this using an old version of CBS s CB SS for version 2.0 and really didn't the intake of but at least it shows the potential of using a vulnerability scoring
00:08:03 [W] more for configuration
00:08:04 [W] and finally the last frame work we looked at that's very interesting is a common configuration animation system CC and what it is is a checklist of checks that you need to apply to make sure that your software is is a cure.
00:08:20 [W] Check these for Apache for example, or a checklist for different OS like hide that and you can basically follow the rules one-by-one and ensure that your software is secure.
00:08:33 [W] So we decided to take the best of all of this framework and apply to kubernative.
00:08:43 [W] So it's the framework case is Casey CSS come with a list of rule just like see see that I'll show you later on in the demo.
00:08:51 [W] They're all described.
00:08:58 [W] There is the same way as CB SS and know that's that's why you see the similarity in KC CSS.
00:08:59 [W] on configuration scoring system and common variability scoring system is because
00:09:04 [W] The risk are described very much like CSS, and we apply this framework to configuration settings like CSS. And what we added on top of it is
00:09:19 [W] Scoring system and common varieties growing system is because the risk are described very much like CSS, and we apply this framework to configuration settings like
00:09:21 [W] It's the individual risk your link to each setting of your workload into an overall workload risk. So in the end, what you want to have is the risk associated with workloads, and we made it specific to kubernative.
00:09:35 [W] So we made some adjustment to CSS like better apply to kubernative.
00:09:40 [W] So what does it look like in practice?
00:09:46 [W] So you have two types of roll? The first one is the risk and just like CBS s a risk as a score from low medium high. It shows the impact to Integrity confidentiality inability
00:09:59 [W] And just like CBS s a risk as a score from low medium high. It shows the impact to Integrity confidentiality and availability.
00:10:03 [W] Each of them beans call from now on low medium to high and what we try to do here is really describe exactly. What is the risk? So if you have a workload which its sharing the host Network,
00:10:14 [W] So if you have a workload which its sharing the horse Network, you know you have too many things one is you bind the IP address of the host Network, which know if it's a public IP address might be exposed to the
00:10:23 [W] On is you have the ability to see traffic so you might be able to see traffic coming from other parts.
00:10:32 [W] So that's why I have different impacts on confidentiality and the webinar team then we explain how easy it is to exploit it.
00:10:46 [W] So do you need you no special tools. Do you need other type of access to be able to take advantage of these specific settings or is it just easy to do a second one is it?
00:10:53 [W] The attack Vector is it remotely exploitable potentially or does it require local axes? And finally the scope is what can you potentially compromised through this risk?
00:11:06 [W] Can you compromise just the container or can you expand and compromise maybe the holes that the container is working on or maybe even the entire entire cluster?
00:11:20 [W] So each role is described in the same way with different values different score for each teacher.
00:11:26 [W] so attributes
00:11:26 [W] the second type is a remediation.
00:11:30 [W] other types of setting other types of risk and an example is if you enable encryption through servicemeshcon
00:12:03 [W] and whether it's protecting just the container or the entire pod and same way as trees.
00:12:11 [W] We try to be very specific in what these remediation or this whole is really really doing
00:12:17 [W] So there is a list of roles list of risk and list of remediation that apply to a workloads.
00:12:46 [W] The impact score. So the highest impact you have on the three attributes availability confidentiality Integrity the higher impact score you have and then you have the exploitability score and that's no busy key tell you
00:13:01 [W] To exploit this aesthetic and you add the two of them and you get a score from zero to ten.
00:13:16 [W] So the first step is to create a risk from 0 to 10 for all the settings that apply to a back road.
00:13:22 [W] you have 10 or 15 risks that are found in this list of rules that apply to a given workloads.
00:13:26 [W] Then from this list of risk we want to compute a risk for the workloads itself.
00:13:36 [W] And what we do is we look at common type of risks that meaning race that has the same attack vectors in scope and we basically say iquivalent and we take the maximum score for
00:13:48 [W] We went and we take the maximum score for all of them.
00:13:51 [W] So if you have to realize that the same attack Vector, so both of them are removed and same scope. Both of them are impacting the container. We take the max maximum risk for all of them. Then we add them up take the square root and
00:14:03 [W] Go from 0 to 10 that described the risk for the entire workloads.
00:14:22 [W] Now you may have noticed that I talked about risk on Yemen talked about remediation. So how do we use the relation holds? So when we pick the list of risk that are socially with workloads, so
00:14:40 [W] Try to find the matching remediation that apply and the much information right now is defined as a remediation that has the same attack vector and same score as a risk.
00:14:54 [W] And basically what we do is we subtract the remediation from the risk.
00:14:59 [W] So if you have a risk that's high impact on confidentiality and the matching or mediation that has a low impact on confidentiality than you subscribe subscribed law from high and you can now get a minikube.
00:15:09 [W] I'm risk, and you do that for all three attributes of ability integrity and confidentiality and you get modified wrist and you actually take this risk as part of the formula to calculate to
00:15:24 [W] Wrist so you compute the list of mitigated risk and you apply the same formula for the overall workload configuration.
00:15:37 [W] So now you've taken into consideration both risk and Remediation and have a better picture of the risk associated with your workload.
00:15:44 [W] So Casey CSS is a framework.
00:15:52 [W] So it's a set of world and a set of formula now to make it easy for anybody to run Cassie CSS in their cluster.
00:16:03 [W] We basically open source and implementation of cases. Yes s called Cube scan.
00:16:09 [W] So keep scan does a job of scanning all of your workload in your cluster mapping this list of risk and Remediation for each of the workload and doing the
00:16:14 [W] I'll bend your wrist and workloads risk based on the cases CSS framework and it shows all of the results in the nice web UI.
00:16:24 [W] So it's time for the Mana to show you actually how it looks like and give you a better idea of what you can try at home on your own on clustered.
00:16:36 [W] Let me share my screen.
00:16:40 [W] To show you the repository for Casey CSS and chips can so everything's on GitHub.
00:16:57 [W] You have the list of rules you have additional information in the wiki about the goal of the project now, how can you make your own role the scoring formula?
00:17:10 [W] So if you want to wait two more details just type get up Casey CSS and you will find this Repository.
00:17:16 [W] Same thing for Kube scan.
00:17:22 [W] We have a GitHub repository where you get all the instruction to install Cube scanning your cluster the source code is available, but we also have
00:17:36 [W] The board so you just have to copy and pass these two comments here in your cluster and it will automatically download and installed the containers and expose it
00:17:52 [W] Cube still put forward which is the safest way.
00:18:01 [W] If you want to share access to the you are you can also expose it for load balancer to just have to use different instruction here.
00:18:08 [W] So all the stores all instruction are in GitHub. And once you install it in your cluster you get this web UI here.
00:18:20 [W] what the web UI here show is the mapping basically of your
00:18:23 [W] Workloads settings with Casey CSS and you see the workloads co here.
00:18:31 [W] So here we go from seven for the highest.
00:18:36 [W] We don't have a 10 and we go down to the your own pretty much no no risk there.
00:18:38 [W] We do have a toggle to show or hide the system namespace like the queue proxy containers that you may not be able to do anything about the scan is do is been is been done on demand.
00:18:51 [W] Angie's now, you can just click on refresh and get the new results.
00:18:56 [W] Also.
00:19:04 [W] I mentioned that it's an installation per cluster. So if you have different closer, you just need to install a new instance of Cubes can in each cluster.
00:19:05 [W] So if you want to get more information about the where there is come from just click on the score here and you see all the risk and Remediation that apply to that Park Road.
00:19:17 [W] So we see that it has a natural capability.
00:19:24 [W] It's privileged but also exposed to potentially to the outside for shareholders Network.
00:19:33 [W] We can drill into each of the risk understand exactly the impact no and all the information why it's bad or what are the potential risk?
00:19:36 [W] And you can see here.
00:19:39 [W] I mentioned that it's potentially exposed to me to the outside, but she doesn't matter because it's not listening port with no incoming traffic to this to this particular container so you can go through all of them.
00:19:53 [W] No understand. What is what is good?
00:19:56 [W] What is bad and and mostly no use information to really decide what you need to do to make your overall.
00:20:05 [W] security posture for your for your cluster
00:20:08 [W] That's it for for the demo.
00:20:16 [W] Through the few few words about what we plan on doing next.
00:20:30 [W] So we always looking at the proving the formulas.
00:20:37 [W] One of the area of improvement right now is how we match risk with relegation.
00:20:38 [W] with the ending a lot more information and metadata, but risk and Remediation and that should allow us to better match risk is remediation. We also already need some improvement to the overall.
00:20:52 [W] Walker risk, so this version of cube scan has the latest formula that I think give us a better spread of risk.
00:20:59 [W] I thought they were workloads.
00:21:06 [W] But if we see looking at making improvements I mentioned that there are about 30 rules today.
00:21:09 [W] We added a few words about our back and there's more coming up.
00:21:17 [W] We looking at other types of old to expand know what we're looking at in a company's cluster and kubernative workloads.
00:21:21 [W] Are putting more information about in like she is meshmark the meter attack framework and I think it's very very interesting because it shows you know, it's a different way of looking at your risk so you can see know what's best
00:21:36 [W] Flying with the 50s which Mark you can look at what's not stages of attack?
00:21:43 [W] You most to say zettabytes with the Mitre like framework. So we want to expand the use of this framework and give you as much information so you can better manage risk and understand what sexual risk and one thing. I'm very excited about
00:21:56 [W] Is more tools to show you how you could fix it.
00:22:12 [W] So I mentioned that one of the goals of the framework was to help your immediate because if you have no workloads that's running as privilege. For example, that's a few obviously a higher risk, but you might not be able to
00:22:19 [W] Not privileged, but when you could do is maybe add or change all the security settings that might that might make your risk lower.
00:22:30 [W] So one of the goals that I have is no an easy way for you to show what are the all the different combinations that are available and how they will impact or not impact your wrist. So if you turn on encryption for
00:22:45 [W] I wouldn't look for your for your secret question.
00:22:50 [W] We can prove all of your workloads.
00:22:55 [W] Maybe some of them now maybe some of the risk our local and have nothing to do with his Network. So we're looking at providing more Tools in addition to keep skin to allow you to better assess
00:23:06 [W] Step that you can take to improve your security posture.
00:23:09 [W] If you want more information go to the GitHub repository that I showed you earlier.
00:23:22 [W] There's more details. You can look at the itch for know you can create your own rule. We really hope that we get more contribution especially around Casey CSS.
00:23:30 [W] You don't have to be a developer.
00:23:31 [W] I'm not developer.
00:23:35 [W] a list of rules in the number format. So it's easy to add modify if you have
00:23:38 [W] Security tools or practices that you are using for kubernative know you can represent a role that will show you how it's improving.
00:23:49 [W] for example your security posture how the out the security tool that you've deployed our meeting some of the issue of potential issues.
00:24:04 [W] So it's easy to extend and it should be easy to create Northerns. Well cubes can also scroll is available. But if what you want is just try
00:24:08 [W] It's can and just copy and past to two lines to keep CL commands and you will have to scan running in your in your cluster.
00:24:16 [W] And again, I'm available for questions, and if know that question, I cannot answer or question that you can think of later. Don't hesitate to to email me.
00:24:32 [W] secure. I hope you enjoyed and we'll go to question now.
00:24:34 [W] But the the slides so I'll make sure the slide are available either through scared or talk or I'll send a link in the in the slack channel to make sure that you can access it.
00:25:18 [W] question about how you can
00:25:25 [W] improve our augment the cases.
00:25:31 [W] Yes framework 2.0. Look at custom labels all the things so it is it is it is possible.
00:25:43 [W] There is a lot of improvements we need to do there. So the idea is that each each roll is represented with Jason past Curry for looking at the specific configuration and its value.
00:25:51 [W] It's not done yet.
00:25:55 [W] So that's the end to put more information on the weekend how to do that.
00:25:59 [W] So hopefully in the coming coming weeks you'll be able to more easily. Add your own role intestine.
00:26:06 [W] I often other words updated so they actually haven't been updated in a while since the last update was to three months ago just before doctoring at got acquired but we hope to make more changes. The new rules that we are looking for
00:26:24 [W] Little bit different from the other.
00:26:26 [W] So we're looking at what we call environment rules that looking at more than one workloads at the time. The example is if you have a namespace we to to workloads
00:26:40 [W] Very very different profile one may affect the security of the others meaning you may have a workload that's exposed to the outside and doesn't have any network policy.
00:26:54 [W] that could be leveraged to access another another workloads in the same namespace that has high local Privileges and access manager communities API so we want to be able
00:27:09 [W] To have this kind of environment or risk and it's a little bit different.
00:27:21 [W] So that's taking a bit longer to figure out exactly how to score that and how to describe this distress that apply to more than one workloads.
00:27:26 [W] Question about how you know how how difficult it is to create the overall risk is you do have to do to rate all individual risk. Again, the idea is naturally to do it manually because
00:27:45 [W] 30 different settings manually and and creating the majorities for that and creating than the overall risk is quite hard.
00:28:01 [W] So that's why I know you have tools like Cube scan was also in the repository a couple of node.js tools that allow you to do that out of context can without doing it
00:28:08 [W] These 3D to run Cube scan or any other program that we do the work of checking the vocal configuration and creating the the risk.
00:28:19 [W] So cubes can run in any kubernetes cluster including open sheet including AWS gcp Azure, so it should running in any.
00:28:35 [W] Anything any quantities environment?
00:28:39 [W] So question about you know, whether how this tool compare your can walk with other security tools such as image scanner.
00:28:54 [W] So this is this is different.
00:28:56 [W] It's not looking at vulnerabilities.
00:28:58 [W] It's really looking at the configuration.
00:29:01 [W] So it is an additional layer of your of your security model.
00:29:12 [W] So you have what's inside the container and then you have how the configure how the container is configured.
00:29:17 [W] So it's it doesn't look at specific CDs, but it is no an additional layer of information and looking and a different layer of security than image scanning.
00:29:25 [W] Question about whether try and forget or not. I don't think we've tried some not sure if it would work with with Stargate.
00:29:37 [W] With the tools such as image scanner.
00:29:39 [W] So this is this is different.
00:29:39 [W] It's not looking at vulnerabilities.
00:29:39 [W] It's really looking at the configuration.
00:29:39 [W] So it is an additional layer of your of your security model.
00:29:41 [W] So you have what's inside the computer and then you have how the configure how the container is configured.
00:29:41 [W] So it's it doesn't look at specific CDs, but it is no an additional layer of information and looking and a different layer of security than image scanning.
00:29:43 [W] Question about whether at random Target or not.
00:29:45 [W] I don't think we've tried so I'm not sure if it would work with with Stargate.
00:29:46 [W] Okay question on how to run Cube scan.
00:29:50 [W] Whether I'm not sure I understand the question.
00:30:00 [W] We're a dessert.
00:30:06 [W] say that skips can run on either sides.
00:30:09 [W] So Cube scan is deployed as a container.
00:30:20 [W] I'm not sure if that's what you mean.
00:30:21 [W] Okay. So how is the score calculated so it so it's very similar to the CSS framework.
00:30:38 [W] We it looks at two main things one is the impact so impact for to availability confidentiality and integrity and each of them is rated
00:30:47 [W] Okay question on how to run Cube scan.
00:30:49 [W] Whether I'm not sure I understand the question.
00:30:49 [W] Where does the scripts can run on infrastructure sides?
00:30:50 [W] So Cube scan is deployed as a container. I'm not sure if that's what you mean.
00:30:51 [W] Okay. So, how is the score calculated?
00:30:53 [W] So so it's very similar to the CSS framework.
00:30:54 [W] It looks at two main things one is the impact so impact for to availability confidentiality and integrity and each of them is rated low
00:30:55 [W] Visited the three and create create this call for the impact and the in I encourage you to look at the at the wiki there's more information there and there's a program that does that then there is the exploitability score which looks
00:31:06 [W] Score which looks at the attack Vector scope and the likelihood of exploit and two of them some together is the individual risk for each setting. So again, very
00:31:20 [W] Very very similar to to CSS.
00:31:30 [W] What's I guess less objective is how do we how do we write the impact?
00:31:32 [W] No, is it a lower Z2 high or medium? So that's you know, we described.
00:31:39 [W] Each impact and will try to show what is exactly is to confidentiality integrity and availability.
00:31:55 [W] And you know, we make the decision on whether the risk is high low or unknown for each of them.
00:32:02 [W] But obviously you can you can take the rules and you know, if you feel like we said that there is too low or too high for for for for setting and change it yourself.
00:32:06 [W] Happy birthday, the reasoning behind the criticality of the severity should be should be found in the description in each hole.
00:32:20 [W] Okay, no other questions so far.
00:32:30 [W] Okay, hopefully you can you all ready to try it.
00:32:48 [W] And I'm sure he would you like more question if you try it, so don't hesitate to reach out with any question or comment or you know, even a feature request.
00:33:02 [W] We'll be happy to look at the weather spok you can sell for for the for the framework.
00:33:10 [W] Okay, no more question.
00:33:18 [W] I'll be available in the selection.
00:33:29 [W] or so. If I didn't answer your question correctly or I didn't understand your question not hesitate to reach out in it's like
00:33:37 [W] Game still waiting for questions to see we have a few minutes left.
00:33:46 [W] So make sure the slide again are available today.
00:34:01 [W] still a few minutes for questions
00:34:18 [W] correctly or I didn't understand your question don't hesitate to reach out in it's like
00:34:21 [W] Okay, I'm still waiting for questions. I think we have a few minutes left.
00:34:21 [W] So make sure the slide again are available today.
00:34:22 [W] still a few minutes for questions
00:34:24 [W] Okay.
00:34:27 [W] So again I'll be available on seccomp.
